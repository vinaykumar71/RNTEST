b2ab44d7152a08162f7e8693f85fed81
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _react = _interopRequireWildcard(require("react"));

var _invariant = _interopRequireDefault(require("invariant"));

var _reactNative = require("react-native");

var _GestureHandler = require("./GestureHandler");

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

var DRAG_TOSS = 0.05;
var IDLE = 'Idle';
var DRAGGING = 'Dragging';
var SETTLING = 'Settling';

var DrawerLayout = function (_Component) {
  (0, _inherits2.default)(DrawerLayout, _Component);

  var _super = _createSuper(DrawerLayout);

  function DrawerLayout(_props, context) {
    var _this;

    (0, _classCallCheck2.default)(this, DrawerLayout);
    _this = _super.call(this, _props, context);
    _this._accessibilityIsModalView = _react.default.createRef();
    _this._pointerEventsView = _react.default.createRef();
    _this._panGestureHandler = _react.default.createRef();
    _this._drawerShown = false;

    _this._updateAnimatedEvent = function (props, state) {
      var drawerPosition = props.drawerPosition,
          drawerWidth = props.drawerWidth,
          drawerType = props.drawerType;
      var dragXValue = state.dragX,
          touchXValue = state.touchX,
          drawerTranslation = state.drawerTranslation,
          containerWidth = state.containerWidth;
      var dragX = dragXValue;
      var touchX = touchXValue;

      if (drawerPosition !== 'left') {
        dragX = _reactNative.Animated.multiply(new _reactNative.Animated.Value(-1), dragXValue);
        touchX = _reactNative.Animated.add(new _reactNative.Animated.Value(containerWidth), _reactNative.Animated.multiply(new _reactNative.Animated.Value(-1), touchXValue));
        touchXValue.setValue(containerWidth);
      } else {
        touchXValue.setValue(0);
      }

      var translationX = dragX;

      if (drawerType === 'front') {
        var startPositionX = _reactNative.Animated.add(touchX, _reactNative.Animated.multiply(new _reactNative.Animated.Value(-1), dragX));

        var dragOffsetFromOnStartPosition = startPositionX.interpolate({
          inputRange: [drawerWidth - 1, drawerWidth, drawerWidth + 1],
          outputRange: [0, 0, 1]
        });
        translationX = _reactNative.Animated.add(dragX, dragOffsetFromOnStartPosition);
      }

      _this._openValue = _reactNative.Animated.add(translationX, drawerTranslation).interpolate({
        inputRange: [0, drawerWidth],
        outputRange: [0, 1],
        extrapolate: 'clamp'
      });
      _this._onGestureEvent = _reactNative.Animated.event([{
        nativeEvent: {
          translationX: dragXValue,
          x: touchXValue
        }
      }], {
        useNativeDriver: props.useNativeAnimations
      });
    };

    _this._handleContainerLayout = function (_ref) {
      var nativeEvent = _ref.nativeEvent;

      _this.setState({
        containerWidth: nativeEvent.layout.width
      });
    };

    _this._emitStateChanged = function (newState, drawerWillShow) {
      _this.props.onDrawerStateChanged && _this.props.onDrawerStateChanged(newState, drawerWillShow);
    };

    _this._openingHandlerStateChange = function (_ref2) {
      var nativeEvent = _ref2.nativeEvent;

      if (nativeEvent.oldState === _GestureHandler.State.ACTIVE) {
        _this._handleRelease(nativeEvent);
      } else if (nativeEvent.state === _GestureHandler.State.ACTIVE) {
        _this._emitStateChanged(DRAGGING, false);

        if (_this.props.keyboardDismissMode === 'on-drag') {
          _reactNative.Keyboard.dismiss();
        }

        if (_this.props.hideStatusBar) {
          _reactNative.StatusBar.setHidden(true, _this.props.statusBarAnimation || 'slide');
        }
      }
    };

    _this._onTapHandlerStateChange = function (_ref3) {
      var nativeEvent = _ref3.nativeEvent;

      if (_this._drawerShown && nativeEvent.oldState === _GestureHandler.State.ACTIVE && _this.props.drawerLockMode !== 'locked-open') {
        _this.closeDrawer();
      }
    };

    _this._handleRelease = function (nativeEvent) {
      var _this$props = _this.props,
          drawerWidth = _this$props.drawerWidth,
          drawerPosition = _this$props.drawerPosition,
          drawerType = _this$props.drawerType;
      var containerWidth = _this.state.containerWidth;
      var dragX = nativeEvent.translationX,
          velocityX = nativeEvent.velocityX,
          touchX = nativeEvent.x;

      if (drawerPosition !== 'left') {
        dragX = -dragX;
        touchX = containerWidth - touchX;
        velocityX = -velocityX;
      }

      var gestureStartX = touchX - dragX;
      var dragOffsetBasedOnStart = 0;

      if (drawerType === 'front') {
        dragOffsetBasedOnStart = gestureStartX > drawerWidth ? gestureStartX - drawerWidth : 0;
      }

      var startOffsetX = dragX + dragOffsetBasedOnStart + (_this._drawerShown ? drawerWidth : 0);
      var projOffsetX = startOffsetX + DRAG_TOSS * velocityX;
      var shouldOpen = projOffsetX > drawerWidth / 2;

      if (shouldOpen) {
        _this._animateDrawer(startOffsetX, drawerWidth, velocityX);
      } else {
        _this._animateDrawer(startOffsetX, 0, velocityX);
      }
    };

    _this._updateShowing = function (showing) {
      _this._drawerShown = showing;
      _this._accessibilityIsModalView.current && _this._accessibilityIsModalView.current.setNativeProps({
        accessibilityViewIsModal: showing
      });
      _this._pointerEventsView.current && _this._pointerEventsView.current.setNativeProps({
        pointerEvents: showing ? 'auto' : 'none'
      });
      var _this$props2 = _this.props,
          drawerPosition = _this$props2.drawerPosition,
          minSwipeDistance = _this$props2.minSwipeDistance,
          edgeWidth = _this$props2.edgeWidth;
      var fromLeft = drawerPosition === 'left';
      var gestureOrientation = (fromLeft ? 1 : -1) * (_this._drawerShown ? -1 : 1);
      var hitSlop = fromLeft ? {
        left: 0,
        width: showing ? undefined : edgeWidth
      } : {
        right: 0,
        width: showing ? undefined : edgeWidth
      };
      _this._panGestureHandler.current && _this._panGestureHandler.current.setNativeProps({
        hitSlop: hitSlop,
        activeOffsetX: gestureOrientation * minSwipeDistance
      });
    };

    _this._animateDrawer = function (fromValue, toValue, velocity) {
      _this.state.dragX.setValue(0);

      _this.state.touchX.setValue(_this.props.drawerPosition === 'left' ? 0 : _this.state.containerWidth);

      if (fromValue != null) {
        var nextFramePosition = fromValue;

        if (_this.props.useNativeAnimations) {
          if (fromValue < toValue && velocity > 0) {
            nextFramePosition = Math.min(fromValue + velocity / 60.0, toValue);
          } else if (fromValue > toValue && velocity < 0) {
            nextFramePosition = Math.max(fromValue + velocity / 60.0, toValue);
          }
        }

        _this.state.drawerTranslation.setValue(nextFramePosition);
      }

      var willShow = toValue !== 0;

      _this._updateShowing(willShow);

      _this._emitStateChanged(SETTLING, willShow);

      if (_this.props.hideStatusBar) {
        _reactNative.StatusBar.setHidden(willShow, _this.props.statusBarAnimation || 'slide');
      }

      _reactNative.Animated.spring(_this.state.drawerTranslation, {
        velocity: velocity,
        bounciness: 0,
        toValue: toValue,
        useNativeDriver: _this.props.useNativeAnimations
      }).start(function (_ref4) {
        var finished = _ref4.finished;

        if (finished) {
          _this._emitStateChanged(IDLE, willShow);

          if (willShow) {
            _this.props.onDrawerOpen && _this.props.onDrawerOpen();
          } else {
            _this.props.onDrawerClose && _this.props.onDrawerClose();
          }
        }
      });
    };

    _this.openDrawer = function () {
      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      _this._animateDrawer(undefined, _this.props.drawerWidth, options.velocity ? options.velocity : 0);

      _this.forceUpdate();
    };

    _this.closeDrawer = function () {
      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      _this._animateDrawer(undefined, 0, options.velocity ? options.velocity : 0);

      _this.forceUpdate();
    };

    _this._renderOverlay = function () {
      (0, _invariant.default)(_this._openValue, 'should be set');

      var overlayOpacity = _this._openValue.interpolate({
        inputRange: [0, 1],
        outputRange: [0, 1],
        extrapolate: 'clamp'
      });

      var dynamicOverlayStyles = {
        opacity: overlayOpacity,
        backgroundColor: _this.props.overlayColor
      };
      return _react.default.createElement(_GestureHandler.TapGestureHandler, {
        onHandlerStateChange: _this._onTapHandlerStateChange
      }, _react.default.createElement(_reactNative.Animated.View, {
        pointerEvents: _this._drawerShown ? 'auto' : 'none',
        ref: _this._pointerEventsView,
        style: [styles.overlay, dynamicOverlayStyles]
      }));
    };

    _this._renderDrawer = function () {
      var _this$props3 = _this.props,
          drawerBackgroundColor = _this$props3.drawerBackgroundColor,
          drawerWidth = _this$props3.drawerWidth,
          drawerPosition = _this$props3.drawerPosition,
          drawerType = _this$props3.drawerType,
          drawerContainerStyle = _this$props3.drawerContainerStyle,
          contentContainerStyle = _this$props3.contentContainerStyle;
      var fromLeft = drawerPosition === 'left';
      var drawerSlide = drawerType !== 'back';
      var containerSlide = drawerType !== 'front';
      var reverseContentDirection = _reactNative.I18nManager.isRTL ? fromLeft : !fromLeft;
      var dynamicDrawerStyles = {
        backgroundColor: drawerBackgroundColor,
        width: drawerWidth
      };
      var openValue = _this._openValue;
      (0, _invariant.default)(openValue, 'should be set');
      var containerStyles;

      if (containerSlide) {
        var containerTranslateX = openValue.interpolate({
          inputRange: [0, 1],
          outputRange: fromLeft ? [0, drawerWidth] : [0, -drawerWidth],
          extrapolate: 'clamp'
        });
        containerStyles = {
          transform: [{
            translateX: containerTranslateX
          }]
        };
      }

      var drawerTranslateX = 0;

      if (drawerSlide) {
        var closedDrawerOffset = fromLeft ? -drawerWidth : drawerWidth;
        drawerTranslateX = openValue.interpolate({
          inputRange: [0, 1],
          outputRange: [closedDrawerOffset, 0],
          extrapolate: 'clamp'
        });
      }

      var drawerStyles = {
        transform: [{
          translateX: drawerTranslateX
        }],
        flexDirection: reverseContentDirection ? 'row-reverse' : 'row'
      };
      return _react.default.createElement(_reactNative.Animated.View, {
        style: styles.main,
        onLayout: _this._handleContainerLayout
      }, _react.default.createElement(_reactNative.Animated.View, {
        style: [drawerType === 'front' ? styles.containerOnBack : styles.containerInFront, containerStyles, contentContainerStyle],
        importantForAccessibility: _this._drawerShown ? 'no-hide-descendants' : 'yes'
      }, typeof _this.props.children === 'function' ? _this.props.children(_this._openValue) : _this.props.children, _this._renderOverlay()), _react.default.createElement(_reactNative.Animated.View, {
        pointerEvents: "box-none",
        ref: _this._accessibilityIsModalView,
        accessibilityViewIsModal: _this._drawerShown,
        style: [styles.drawerContainer, drawerStyles, drawerContainerStyle]
      }, _react.default.createElement(_reactNative.View, {
        style: dynamicDrawerStyles
      }, _this.props.renderNavigationView(_this._openValue))));
    };

    _this._setPanGestureRef = function (ref) {
      _this._panGestureHandler.current = ref;
      _this.props.onGestureRef && _this.props.onGestureRef(ref);
    };

    var _dragX = new _reactNative.Animated.Value(0);

    var _touchX = new _reactNative.Animated.Value(0);

    var _drawerTranslation = new _reactNative.Animated.Value(0);

    _this.state = {
      dragX: _dragX,
      touchX: _touchX,
      drawerTranslation: _drawerTranslation,
      containerWidth: 0
    };

    _this._updateAnimatedEvent(_props, _this.state);

    return _this;
  }

  (0, _createClass2.default)(DrawerLayout, [{
    key: "UNSAFE_componentWillUpdate",
    value: function UNSAFE_componentWillUpdate(props, state) {
      if (this.props.drawerPosition !== props.drawerPosition || this.props.drawerWidth !== props.drawerWidth || this.props.drawerType !== props.drawerType || this.state.containerWidth !== state.containerWidth) {
        this._updateAnimatedEvent(props, state);
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this$props4 = this.props,
          drawerPosition = _this$props4.drawerPosition,
          drawerLockMode = _this$props4.drawerLockMode,
          edgeWidth = _this$props4.edgeWidth,
          minSwipeDistance = _this$props4.minSwipeDistance;
      var fromLeft = drawerPosition === 'left';
      var gestureOrientation = (fromLeft ? 1 : -1) * (this._drawerShown ? -1 : 1);
      var hitSlop = fromLeft ? {
        left: 0,
        width: this._drawerShown ? undefined : edgeWidth
      } : {
        right: 0,
        width: this._drawerShown ? undefined : edgeWidth
      };
      return _react.default.createElement(_GestureHandler.PanGestureHandler, {
        ref: this._setPanGestureRef,
        hitSlop: hitSlop,
        activeOffsetX: gestureOrientation * minSwipeDistance,
        failOffsetY: [-15, 15],
        onGestureEvent: this._onGestureEvent,
        onHandlerStateChange: this._openingHandlerStateChange,
        enabled: drawerLockMode !== 'locked-closed' && drawerLockMode !== 'locked-open'
      }, this._renderDrawer());
    }
  }]);
  return DrawerLayout;
}(_react.Component);

exports.default = DrawerLayout;
DrawerLayout.defaultProps = {
  drawerWidth: 200,
  drawerPosition: 'left',
  useNativeAnimations: true,
  drawerType: 'front',
  edgeWidth: 20,
  minSwipeDistance: 3,
  overlayColor: 'rgba(0, 0, 0, 0.7)',
  drawerLockMode: 'unlocked'
};
DrawerLayout.positions = {
  Left: 'left',
  Right: 'right'
};

var styles = _reactNative.StyleSheet.create({
  drawerContainer: _objectSpread(_objectSpread({}, _reactNative.StyleSheet.absoluteFillObject), {}, {
    zIndex: 1001,
    flexDirection: 'row'
  }),
  containerInFront: _objectSpread(_objectSpread({}, _reactNative.StyleSheet.absoluteFillObject), {}, {
    zIndex: 1002
  }),
  containerOnBack: _objectSpread({}, _reactNative.StyleSheet.absoluteFillObject),
  main: {
    flex: 1,
    zIndex: 0,
    overflow: 'hidden'
  },
  overlay: _objectSpread(_objectSpread({}, _reactNative.StyleSheet.absoluteFillObject), {}, {
    zIndex: 1000
  })
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRyYXdlckxheW91dC5qcyJdLCJuYW1lcyI6WyJEUkFHX1RPU1MiLCJJRExFIiwiRFJBR0dJTkciLCJTRVRUTElORyIsIkRyYXdlckxheW91dCIsInByb3BzIiwiY29udGV4dCIsIl9hY2Nlc3NpYmlsaXR5SXNNb2RhbFZpZXciLCJSZWFjdCIsImNyZWF0ZVJlZiIsIl9wb2ludGVyRXZlbnRzVmlldyIsIl9wYW5HZXN0dXJlSGFuZGxlciIsIl9kcmF3ZXJTaG93biIsIl91cGRhdGVBbmltYXRlZEV2ZW50Iiwic3RhdGUiLCJkcmF3ZXJQb3NpdGlvbiIsImRyYXdlcldpZHRoIiwiZHJhd2VyVHlwZSIsImRyYWdYVmFsdWUiLCJkcmFnWCIsInRvdWNoWFZhbHVlIiwidG91Y2hYIiwiZHJhd2VyVHJhbnNsYXRpb24iLCJjb250YWluZXJXaWR0aCIsIkFuaW1hdGVkIiwibXVsdGlwbHkiLCJWYWx1ZSIsImFkZCIsInNldFZhbHVlIiwidHJhbnNsYXRpb25YIiwic3RhcnRQb3NpdGlvblgiLCJkcmFnT2Zmc2V0RnJvbU9uU3RhcnRQb3NpdGlvbiIsImludGVycG9sYXRlIiwiaW5wdXRSYW5nZSIsIm91dHB1dFJhbmdlIiwiX29wZW5WYWx1ZSIsImV4dHJhcG9sYXRlIiwiX29uR2VzdHVyZUV2ZW50IiwiZXZlbnQiLCJuYXRpdmVFdmVudCIsIngiLCJ1c2VOYXRpdmVEcml2ZXIiLCJ1c2VOYXRpdmVBbmltYXRpb25zIiwiX2hhbmRsZUNvbnRhaW5lckxheW91dCIsInNldFN0YXRlIiwibGF5b3V0Iiwid2lkdGgiLCJfZW1pdFN0YXRlQ2hhbmdlZCIsIm5ld1N0YXRlIiwiZHJhd2VyV2lsbFNob3ciLCJvbkRyYXdlclN0YXRlQ2hhbmdlZCIsIl9vcGVuaW5nSGFuZGxlclN0YXRlQ2hhbmdlIiwib2xkU3RhdGUiLCJTdGF0ZSIsIkFDVElWRSIsIl9oYW5kbGVSZWxlYXNlIiwia2V5Ym9hcmREaXNtaXNzTW9kZSIsIktleWJvYXJkIiwiZGlzbWlzcyIsImhpZGVTdGF0dXNCYXIiLCJTdGF0dXNCYXIiLCJzZXRIaWRkZW4iLCJzdGF0dXNCYXJBbmltYXRpb24iLCJfb25UYXBIYW5kbGVyU3RhdGVDaGFuZ2UiLCJkcmF3ZXJMb2NrTW9kZSIsImNsb3NlRHJhd2VyIiwidmVsb2NpdHlYIiwiZ2VzdHVyZVN0YXJ0WCIsImRyYWdPZmZzZXRCYXNlZE9uU3RhcnQiLCJzdGFydE9mZnNldFgiLCJwcm9qT2Zmc2V0WCIsInNob3VsZE9wZW4iLCJfYW5pbWF0ZURyYXdlciIsIl91cGRhdGVTaG93aW5nIiwic2hvd2luZyIsImN1cnJlbnQiLCJzZXROYXRpdmVQcm9wcyIsImFjY2Vzc2liaWxpdHlWaWV3SXNNb2RhbCIsInBvaW50ZXJFdmVudHMiLCJtaW5Td2lwZURpc3RhbmNlIiwiZWRnZVdpZHRoIiwiZnJvbUxlZnQiLCJnZXN0dXJlT3JpZW50YXRpb24iLCJoaXRTbG9wIiwibGVmdCIsInVuZGVmaW5lZCIsInJpZ2h0IiwiYWN0aXZlT2Zmc2V0WCIsImZyb21WYWx1ZSIsInRvVmFsdWUiLCJ2ZWxvY2l0eSIsIm5leHRGcmFtZVBvc2l0aW9uIiwiTWF0aCIsIm1pbiIsIm1heCIsIndpbGxTaG93Iiwic3ByaW5nIiwiYm91bmNpbmVzcyIsInN0YXJ0IiwiZmluaXNoZWQiLCJvbkRyYXdlck9wZW4iLCJvbkRyYXdlckNsb3NlIiwib3BlbkRyYXdlciIsIm9wdGlvbnMiLCJmb3JjZVVwZGF0ZSIsIl9yZW5kZXJPdmVybGF5Iiwib3ZlcmxheU9wYWNpdHkiLCJkeW5hbWljT3ZlcmxheVN0eWxlcyIsIm9wYWNpdHkiLCJiYWNrZ3JvdW5kQ29sb3IiLCJvdmVybGF5Q29sb3IiLCJzdHlsZXMiLCJvdmVybGF5IiwiX3JlbmRlckRyYXdlciIsImRyYXdlckJhY2tncm91bmRDb2xvciIsImRyYXdlckNvbnRhaW5lclN0eWxlIiwiY29udGVudENvbnRhaW5lclN0eWxlIiwiZHJhd2VyU2xpZGUiLCJjb250YWluZXJTbGlkZSIsInJldmVyc2VDb250ZW50RGlyZWN0aW9uIiwiSTE4bk1hbmFnZXIiLCJpc1JUTCIsImR5bmFtaWNEcmF3ZXJTdHlsZXMiLCJvcGVuVmFsdWUiLCJjb250YWluZXJTdHlsZXMiLCJjb250YWluZXJUcmFuc2xhdGVYIiwidHJhbnNmb3JtIiwidHJhbnNsYXRlWCIsImRyYXdlclRyYW5zbGF0ZVgiLCJjbG9zZWREcmF3ZXJPZmZzZXQiLCJkcmF3ZXJTdHlsZXMiLCJmbGV4RGlyZWN0aW9uIiwibWFpbiIsImNvbnRhaW5lck9uQmFjayIsImNvbnRhaW5lckluRnJvbnQiLCJjaGlsZHJlbiIsImRyYXdlckNvbnRhaW5lciIsInJlbmRlck5hdmlnYXRpb25WaWV3IiwiX3NldFBhbkdlc3R1cmVSZWYiLCJyZWYiLCJvbkdlc3R1cmVSZWYiLCJDb21wb25lbnQiLCJkZWZhdWx0UHJvcHMiLCJwb3NpdGlvbnMiLCJMZWZ0IiwiUmlnaHQiLCJTdHlsZVNoZWV0IiwiY3JlYXRlIiwiYWJzb2x1dGVGaWxsT2JqZWN0IiwiekluZGV4IiwiZmxleCIsIm92ZXJmbG93Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFVQTs7QUFDQTs7QUFDQTs7QUFTQTs7Ozs7Ozs7OztBQUVBLElBQU1BLFNBQVMsR0FBRyxJQUFsQjtBQUVBLElBQU1DLElBQUksR0FBRyxNQUFiO0FBQ0EsSUFBTUMsUUFBUSxHQUFHLFVBQWpCO0FBQ0EsSUFBTUMsUUFBUSxHQUFHLFVBQWpCOztJQTZDcUJDLFk7Ozs7O0FBdUJuQix3QkFBWUMsTUFBWixFQUE2QkMsT0FBN0IsRUFBMkM7QUFBQTs7QUFBQTtBQUN6Qyw4QkFBTUQsTUFBTixFQUFhQyxPQUFiO0FBRHlDLFVBTDNDQyx5QkFLMkMsR0FMZkMsZUFBTUMsU0FBTixFQUtlO0FBQUEsVUFKM0NDLGtCQUkyQyxHQUp0QkYsZUFBTUMsU0FBTixFQUlzQjtBQUFBLFVBSDNDRSxrQkFHMkMsR0FIdEJILGVBQU1DLFNBQU4sRUFHc0I7QUFBQSxVQUYzQ0csWUFFMkMsR0FGNUIsS0FFNEI7O0FBQUEsVUE0QjNDQyxvQkE1QjJDLEdBNEJwQixVQUFD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QUFNLEVBQUUsSUFGSztBQUdibEIsSUFBQUEsYUFBYSxFQUFFO0FBSEYsSUFEZ0I7QUFNL0JHLEVBQUFBLGdCQUFnQixrQ0FDWFksd0JBQVdFLGtCQURBO0FBRWRDLElBQUFBLE1BQU0sRUFBRTtBQUZNLElBTmU7QUFVL0JoQixFQUFBQSxlQUFlLG9CQUNWYSx3QkFBV0Usa0JBREQsQ0FWZ0I7QUFhL0JoQixFQUFBQSxJQUFJLEVBQUU7QUFDSmtCLElBQUFBLElBQUksRUFBRSxDQURGO0FBRUpELElBQUFBLE1BQU0sRUFBRSxDQUZKO0FBR0pFLElBQUFBLFFBQVEsRUFBRTtBQUhOLEdBYnlCO0FBa0IvQnZDLEVBQUFBLE9BQU8sa0NBQ0ZrQyx3QkFBV0Usa0JBRFQ7QUFFTEMsSUFBQUEsTUFBTSxFQUFFO0FBRkg7QUFsQndCLENBQWxCLENBQWYiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAZmxvd1xuXG4vLyBUaGlzIGNvbXBvbmVudCBpcyBiYXNlZCBvbiBSTidzIERyYXdlckxheW91dEFuZHJvaWQgQVBJXG4vL1xuLy8gSXQgcGVyaGFwcyBkZXNlcnZlcyB0byBiZSBwdXQgaW4gYSBzZXBhcmF0ZSByZXBvLCBidXQgc2luY2UgaXQgcmVsaWVzXG4vLyBvbiByZWFjdC1uYXRpdmUtZ2VzdHVyZS1oYW5kbGVyIGxpYnJhcnkgd2hpY2ggaXNuJ3QgdmVyeSBwb3B1bGFyIGF0IHRoZVxuLy8gbW9tZW50IEkgZGVjaWRlZCB0byBrZWVwIGl0IGhlcmUgZm9yIHRoZSB0aW1lIGJlaW5nLiBJdCB3aWxsIGFsbG93IHVzXG4vLyB0byBtb3ZlIGZhc3RlciBhbmQgZml4IGlzc3VlcyB0aGF0IG1heSBhcmlzZSBpbiBnZXN0dXJlIGhhbmRsZXIgbGlicmFyeVxuLy8gdGhhdCBjb3VsZCBiZSBmb3VuZCB3aGVuIHVzaW5nIHRoZSBkcmF3ZXIgY29tcG9uZW50XG5cbmltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgaW52YXJpYW50IGZyb20gJ2ludmFyaWFudCc7XG5pbXBvcnQge1xuICBBbmltYXRlZCxcbiAgU3R5bGVTaGVldCxcbiAgVmlldyxcbiAgS2V5Ym9hcmQsXG4gIFN0YXR1c0JhcixcbiAgSTE4bk1hbmFnZXIsXG59IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG5cbmltcG9ydCB7IFBhbkdlc3R1cmVIYW5kbGVyLCBUYXBHZXN0dXJlSGFuZGxlciwgU3RhdGUgfSBmcm9tICcuL0dlc3R1cmVIYW5kbGVyJztcblxuY29uc3QgRFJBR19UT1NTID0gMC4wNTtcblxuY29uc3QgSURMRSA9ICdJZGxlJztcbmNvbnN0IERSQUdHSU5HID0gJ0RyYWdnaW5nJztcbmNvbnN0IFNFVFRMSU5HID0gJ1NldHRsaW5nJztcblxuZXhwb3J0IHR5cGUgUHJvcFR5cGUgPSB7XG4gIGNoaWxkcmVuOiBhbnksXG4gIGRyYXdlckJhY2tncm91bmRDb2xvcj86IHN0cmluZyxcbiAgZHJhd2VyUG9zaXRpb246ICdsZWZ0JyB8ICdyaWdodCcsXG4gIGRyYXdlckxvY2tNb2RlPzogJ3VubG9ja2VkJyB8ICdsb2NrZWQtY2xvc2VkJyB8ICdsb2NrZWQtb3BlbicsXG4gIGRyYXdlcldpZHRoOiBudW1iZXIsXG4gIGtleWJvYXJkRGlzbWlzc01vZGU/OiAnbm9uZScgfCAnb24tZHJhZycsXG4gIG9uRHJhd2VyQ2xvc2U/OiBGdW5jdGlvbixcbiAgb25EcmF3ZXJPcGVuPzogRnVuY3Rpb24sXG4gIG9uRHJhd2VyU3RhdGVDaGFuZ2VkPzogRnVuY3Rpb24sXG4gIHJlbmRlck5hdmlnYXRpb25WaWV3OiAocHJvZ3Jlc3NBbmltYXRlZFZhbHVlOiBhbnkpID0+IGFueSxcbiAgdXNlTmF0aXZlQW5pbWF0aW9uczogYm9vbGVhbixcblxuICAvLyBicmFuZCBuZXcgcHJvcGVydGllc1xuICBkcmF3ZXJUeXBlOiAnZnJvbnQnIHwgJ2JhY2snIHwgJ3NsaWRlJyxcbiAgZWRnZVdpZHRoOiBudW1iZXIsXG4gIG1pblN3aXBlRGlzdGFuY2U6IG51bWJlcixcbiAgaGlkZVN0YXR1c0Jhcj86IGJvb2xlYW4sXG4gIHN0YXR1c0JhckFuaW1hdGlvbj86ICdzbGlkZScgfCAnbm9uZScgfCAnZmFkZScsXG4gIG92ZXJsYXlDb2xvcjogc3RyaW5nLFxuICBkcmF3ZXJDb250YWluZXJTdHlsZT86IGFueSxcbiAgY29udGVudENvbnRhaW5lclN0eWxlPzogYW55LFxuICBvbkdlc3R1cmVSZWY/OiBGdW5jdGlvbixcblxuICAvLyBQcm9wZXJ0aWVzIG5vdCB5ZXQgc3VwcG9ydGVkXG4gIC8vIG9uRHJhd2VyU2xpZGU/OiBGdW5jdGlvblxufTtcblxuZXhwb3J0IHR5cGUgU3RhdGVUeXBlID0ge1xuICBkcmFnWDogYW55LFxuICB0b3VjaFg6IGFueSxcbiAgZHJhd2VyVHJhbnNsYXRpb246IGFueSxcbiAgY29udGFpbmVyV2lkdGg6IG51bWJlcixcbn07XG5cbmV4cG9ydCB0eXBlIEV2ZW50VHlwZSA9IHtcbiAgc3RvcFByb3BhZ2F0aW9uOiBGdW5jdGlvbixcbn07XG5cbmV4cG9ydCB0eXBlIERyYXdlck1vdmVtZW50T3B0aW9uVHlwZSA9IHtcbiAgdmVsb2NpdHk/OiBudW1iZXIsXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEcmF3ZXJMYXlvdXQgZXh0ZW5kcyBDb21wb25lbnQ8UHJvcFR5cGUsIFN0YXRlVHlwZT4ge1xuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIGRyYXdlcldpZHRoOiAyMDAsXG4gICAgZHJhd2VyUG9zaXRpb246ICdsZWZ0JyxcbiAgICB1c2VOYXRpdmVBbmltYXRpb25zOiB0cnVlLFxuICAgIGRyYXdlclR5cGU6ICdmcm9udCcsXG4gICAgZWRnZVdpZHRoOiAyMCxcbiAgICBtaW5Td2lwZURpc3RhbmNlOiAzLFxuICAgIG92ZXJsYXlDb2xvcjogJ3JnYmEoMCwgMCwgMCwgMC43KScsXG4gICAgZHJhd2VyTG9ja01vZGU6ICd1bmxvY2tlZCcsXG4gIH07XG5cbiAgc3RhdGljIHBvc2l0aW9ucyA9IHtcbiAgICBMZWZ0OiAnbGVmdCcsXG4gICAgUmlnaHQ6ICdyaWdodCcsXG4gIH07XG4gIF9vcGVuVmFsdWU6ID9BbmltYXRlZC5JbnRlcnBvbGF0aW9uO1xuICBfb25HZXN0dXJlRXZlbnQ6ID9BbmltYXRlZC5FdmVudDtcbiAgX2FjY2Vzc2liaWxpdHlJc01vZGFsVmlldyA9IFJlYWN0LmNyZWF0ZVJlZigpO1xuICBfcG9pbnRlckV2ZW50c1ZpZXcgPSBSZWFjdC5jcmVhdGVSZWYoKTtcbiAgX3Bhbkdlc3R1cmVIYW5kbGVyID0gUmVhY3QuY3JlYXRlUmVmKCk7XG4gIF9kcmF3ZXJTaG93biA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wVHlwZSwgY29udGV4dDogYW55KSB7XG4gICAgc3VwZXIocHJvcHMsIGNvbnRleHQpO1xuXG4gICAgY29uc3QgZHJhZ1ggPSBuZXcgQW5pbWF0ZWQuVmFsdWUoMCk7XG4gICAgY29uc3QgdG91Y2hYID0gbmV3IEFuaW1hdGVkLlZhbHVlKDApO1xuICAgIGNvbnN0IGRyYXdlclRyYW5zbGF0aW9uID0gbmV3IEFuaW1hdGVkLlZhbHVlKDApO1xuXG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGRyYWdYLFxuICAgICAgdG91Y2hYLFxuICAgICAgZHJhd2VyVHJhbnNsYXRpb24sXG4gICAgICBjb250YWluZXJXaWR0aDogMCxcbiAgICB9O1xuXG4gICAgdGhpcy5fdXBkYXRlQW5pbWF0ZWRFdmVudChwcm9wcywgdGhpcy5zdGF0ZSk7XG4gIH1cblxuICBVTlNBRkVfY29tcG9uZW50V2lsbFVwZGF0ZShwcm9wczogUHJvcFR5cGUsIHN0YXRlOiBTdGF0ZVR5cGUpIHtcbiAgICBpZiAoXG4gICAgICB0aGlzLnByb3BzLmRyYXdlclBvc2l0aW9uICE9PSBwcm9wcy5kcmF3ZXJQb3NpdGlvbiB8fFxuICAgICAgdGhpcy5wcm9wcy5kcmF3ZXJXaWR0aCAhPT0gcHJvcHMuZHJhd2VyV2lkdGggfHxcbiAgICAgIHRoaXMucHJvcHMuZHJhd2VyVHlwZSAhPT0gcHJvcHMuZHJhd2VyVHlwZSB8fFxuICAgICAgdGhpcy5zdGF0ZS5jb250YWluZXJXaWR0aCAhPT0gc3RhdGUuY29udGFpbmVyV2lkdGhcbiAgICApIHtcbiAgICAgIHRoaXMuX3VwZGF0ZUFuaW1hdGVkRXZlbnQocHJvcHMsIHN0YXRlKTtcbiAgICB9XG4gIH1cblxuICBfdXBkYXRlQW5pbWF0ZWRFdmVudCA9IChwcm9wczogUHJvcFR5cGUsIHN0YXRlOiBTdGF0ZVR5cGUpID0+IHtcbiAgICAvLyBFdmVudCBkZWZpbml0aW9uIGlzIGJhc2VkIG9uXG4gICAgY29uc3QgeyBkcmF3ZXJQb3NpdGlvbiwgZHJhd2VyV2lkdGgsIGRyYXdlclR5cGUgfSA9IHByb3BzO1xuICAgIGNvbnN0IHtcbiAgICAgIGRyYWdYOiBkcmFnWFZhbHVlLFxuICAgICAgdG91Y2hYOiB0b3VjaFhWYWx1ZSxcbiAgICAgIGRyYXdlclRyYW5zbGF0aW9uLFxuICAgICAgY29udGFpbmVyV2lkdGgsXG4gICAgfSA9IHN0YXRlO1xuXG4gICAgbGV0IGRyYWdYID0gZHJhZ1hWYWx1ZTtcbiAgICBsZXQgdG91Y2hYID0gdG91Y2hYVmFsdWU7XG5cbiAgICBpZiAoZHJhd2VyUG9zaXRpb24gIT09ICdsZWZ0Jykge1xuICAgICAgLy8gTW9zdCBvZiB0aGUgY29kZSBpcyB3cml0dGVuIGluIGEgd2F5IHRvIGhhbmRsZSBsZWZ0LXNpZGUgZHJhd2VyLlxuICAgICAgLy8gSW4gb3JkZXIgdG8gaGFuZGxlIHJpZ2h0LXNpZGUgZHJhd2VyIHRoZSBvbmx5IHRoaW5nIHdlIG5lZWQgdG9cbiAgICAgIC8vIGRvIGlzIHRvIHJldmVyc2UgZXZlbnRzIGNvbWluZyBmcm9tIGdlc3R1cmUgaGFuZGxlciBpbiBhIHdheSB0aGV5XG4gICAgICAvLyBlbXVsYXRlIGxlZnQtc2lkZSBkcmF3ZXIgZ2VzdHVyZXMuIEUuZy4gZHJhZ1ggaXMgc2ltcGx5IC1kcmFnWCwgYW5kXG4gICAgICAvLyB0b3VjaFggaXMgY2FsdWxjYXRlZCBieSBzdWJ0cmFjaW5nIHJlYWwgdG91Y2hYIGZyb20gdGhlIHdpZHRoIG9mIHRoZVxuICAgICAgLy8gY29udGFpbmVyIChzdWNoIHRoYXQgd2hlbiB0b3VjaCBoYXBwZW5zIGF0IHRoZSByaWdodCBlZGdlIHRoZSB2YWx1ZVxuICAgICAgLy8gaXMgc2ltcGx5IDApXG4gICAgICBkcmFnWCA9IEFuaW1hdGVkLm11bHRpcGx5KG5ldyBBbmltYXRlZC5WYWx1ZSgtMSksIGRyYWdYVmFsdWUpO1xuICAgICAgdG91Y2hYID0gQW5pbWF0ZWQuYWRkKFxuICAgICAgICBuZXcgQW5pbWF0ZWQuVmFsdWUoY29udGFpbmVyV2lkdGgpLFxuICAgICAgICBBbmltYXRlZC5tdWx0aXBseShuZXcgQW5pbWF0ZWQuVmFsdWUoLTEpLCB0b3VjaFhWYWx1ZSlcbiAgICAgICk7XG4gICAgICB0b3VjaFhWYWx1ZS5zZXRWYWx1ZShjb250YWluZXJXaWR0aCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRvdWNoWFZhbHVlLnNldFZhbHVlKDApO1xuICAgIH1cblxuICAgIC8vIFdoaWxlIGNsb3NpbmcgdGhlIGRyYXdlciB3aGVuIHVzZXIgc3RhcnRzIGdlc3R1cmUgb3V0c2lkZSBvZiBpdHMgYXJlYSAoaW4gZ3JleWVkXG4gICAgLy8gb3V0IHBhcnQgb2YgdGhlIHdpbmRvdyksIHdlIHdhbnQgdGhlIGRyYXdlciB0byBmb2xsb3cgb25seSBvbmNlIGZpbmdlciByZWFjaGVzIHRoZVxuICAgIC8vIGVkZ2Ugb2YgdGhlIGRyYXdlci5cbiAgICAvLyBFLmcuIG9uIHRoZSBkaWFncmFtIGJlbG93IGRyYXdlciBpcyBpbGx1c3RyYXRlIGJ5IFggc2lnbnMgYW5kIHRoZSBncmV5ZWQgb3V0IGFyZWEgYnlcbiAgICAvLyBkb3RzLiBUaGUgdG91Y2ggZ2VzdHVyZSBzdGFydHMgYXQgJyonIGFuZCBtb3ZlcyBsZWZ0LCB0b3VjaCBwYXRoIGlzIGluZGljYXRlZCBieVxuICAgIC8vIGFuIGFycm93IHBvaW50aW5nIGxlZnRcbiAgICAvLyAxKSArLS0tLS0tLS0tLS0tLS0tKyAyKSArLS0tLS0tLS0tLS0tLS0tKyAzKSArLS0tLS0tLS0tLS0tLS0tKyA0KSArLS0tLS0tLS0tLS0tLS0tK1xuICAgIC8vICAgIHxYWFhYWFhYWHwuLi4uLi58ICAgIHxYWFhYWFhYWHwuLi4uLi58ICAgIHxYWFhYWFhYWHwuLi4uLi58ICAgIHxYWFhYWHwuLi4uLi4uLi58XG4gICAgLy8gICAgfFhYWFhYWFhYfC4uLi4uLnwgICAgfFhYWFhYWFhYfC4uLi4uLnwgICAgfFhYWFhYWFhYfC4uLi4uLnwgICAgfFhYWFhYfC4uLi4uLi4uLnxcbiAgICAvLyAgICB8WFhYWFhYWFh8Li4uLi4ufCAgICB8WFhYWFhYWFh8Li4uLi4ufCAgICB8WFhYWFhYWFh8Li4uLi4ufCAgICB8WFhYWFh8Li4uLi4uLi4ufFxuICAgIC8vICAgIHxYWFhYWFhYWHwuLi4uLi58ICAgIHxYWFhYWFhYWHwuPC0qLi58ICAgIHxYWFhYWFhYWHw8LS0qLi58ICAgIHxYWFhYWHw8LS0tLS0qLi58XG4gICAgLy8gICAgfFhYWFhYWFhYfC4uLi4uLnwgICAgfFhYWFhYWFhYfC4uLi4uLnwgICAgfFhYWFhYWFhYfC4uLi4uLnwgICAgfFhYWFhYfC4uLi4uLi4uLnxcbiAgICAvLyAgICB8WFhYWFhYWFh8Li4uLi4ufCAgICB8WFhYWFhYWFh8Li4uLi4ufCAgICB8WFhYWFhYWFh8Li4uLi4ufCAgICB8WFhYWFh8Li4uLi4uLi4ufFxuICAgIC8vICAgIHxYWFhYWFhYWHwuLi4uLi58ICAgIHxYWFhYWFhYWHwuLi4uLi58ICAgIHxYWFhYWFhYWHwuLi4uLi58ICAgIHxYWFhYWHwuLi4uLi4uLi58XG4gICAgLy8gICAgKy0tLS0tLS0tLS0tLS0tLSsgICAgKy0tLS0tLS0tLS0tLS0tLSsgICAgKy0tLS0tLS0tLS0tLS0tLSsgICAgKy0tLS0tLS0tLS0tLS0tLStcbiAgICAvL1xuICAgIC8vIEZvciB0aGUgYWJvdmUgdG8gd29yayBwcm9wZXJseSB3ZSBkZWZpbmUgYW5pbWF0ZWQgdmFsdWUgdGhhdCB3aWxsIGtlZXAgc3RhcnQgcG9zaXRpb25cbiAgICAvLyBvZiB0aGUgZ2VzdHVyZS4gVGhlbiB3ZSB1c2UgdGhhdCB2YWx1ZSB0byBjYWxjdWxhdGUgaG93IG11Y2ggd2UgbmVlZCB0byBzdWJ0cmFjdCBmcm9tXG4gICAgLy8gdGhlIGRyYWdYLiBJZiB0aGUgZ2VzdHVyZSBzdGFydGVkIG9uIHRoZSBncmV5ZWQgb3V0IGFyZWEgd2UgdGFrZSB0aGUgZGlzdGFuY2UgZnJvbSB0aGVcbiAgICAvLyBlZGdlIG9mIHRoZSBkcmF3ZXIgdG8gdGhlIHN0YXJ0IHBvc2l0aW9uLiBPdGhlcndpc2Ugd2UgZG9uJ3Qgc3VidHJhY3QgYXQgYWxsIGFuZCB0aGVcbiAgICAvLyBkcmF3ZXIgYmUgcHVsbGVkIGJhY2sgYXMgc29vbiBhcyB5b3Ugc3RhcnQgdGhlIHBhbi5cbiAgICAvL1xuICAgIC8vIFRoaXMgaXMgdXNlZCBvbmx5IHdoZW4gZHJhd2VyVHlwZSBpcyBcImZyb250XCJcbiAgICAvL1xuICAgIGxldCB0cmFuc2xhdGlvblggPSBkcmFnWDtcbiAgICBpZiAoZHJhd2VyVHlwZSA9PT0gJ2Zyb250Jykge1xuICAgICAgY29uc3Qgc3RhcnRQb3NpdGlvblggPSBBbmltYXRlZC5hZGQoXG4gICAgICAgIHRvdWNoWCxcbiAgICAgICAgQW5pbWF0ZWQubXVsdGlwbHkobmV3IEFuaW1hdGVkLlZhbHVlKC0xKSwgZHJhZ1gpXG4gICAgICApO1xuXG4gICAgICBjb25zdCBkcmFnT2Zmc2V0RnJvbU9uU3RhcnRQb3NpdGlvbiA9IHN0YXJ0UG9zaXRpb25YLmludGVycG9sYXRlKHtcbiAgICAgICAgaW5wdXRSYW5nZTogW2RyYXdlcldpZHRoIC0gMSwgZHJhd2VyV2lkdGgsIGRyYXdlcldpZHRoICsgMV0sXG4gICAgICAgIG91dHB1dFJhbmdlOiBbMCwgMCwgMV0sXG4gICAgICB9KTtcbiAgICAgIHRyYW5zbGF0aW9uWCA9IEFuaW1hdGVkLmFkZChkcmFnWCwgZHJhZ09mZnNldEZyb21PblN0YXJ0UG9zaXRpb24pO1xuICAgIH1cblxuICAgIHRoaXMuX29wZW5WYWx1ZSA9IEFuaW1hdGVkLmFkZCh0cmFuc2xhdGlvblgsIGRyYXdlclRyYW5zbGF0aW9uKS5pbnRlcnBvbGF0ZShcbiAgICAgIHtcbiAgICAgICAgaW5wdXRSYW5nZTogWzAsIGRyYXdlcldpZHRoXSxcbiAgICAgICAgb3V0cHV0UmFuZ2U6IFswLCAxXSxcbiAgICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgICB9XG4gICAgKTtcblxuICAgIHRoaXMuX29uR2VzdHVyZUV2ZW50ID0gQW5pbWF0ZWQuZXZlbnQoXG4gICAgICBbeyBuYXRpdmVFdmVudDogeyB0cmFuc2xhdGlvblg6IGRyYWdYVmFsdWUsIHg6IHRvdWNoWFZhbHVlIH0gfV0sXG4gICAgICB7IHVzZU5hdGl2ZURyaXZlcjogcHJvcHMudXNlTmF0aXZlQW5pbWF0aW9ucyB9XG4gICAgKTtcbiAgfTtcblxuICBfaGFuZGxlQ29udGFpbmVyTGF5b3V0ID0gKHsgbmF0aXZlRXZlbnQgfSkgPT4ge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBjb250YWluZXJXaWR0aDogbmF0aXZlRXZlbnQubGF5b3V0LndpZHRoIH0pO1xuICB9O1xuXG4gIF9lbWl0U3RhdGVDaGFuZ2VkID0gKG5ld1N0YXRlOiBzdHJpbmcsIGRyYXdlcldpbGxTaG93OiBib29sZWFuKSA9PiB7XG4gICAgdGhpcy5wcm9wcy5vbkRyYXdlclN0YXRlQ2hhbmdlZCAmJlxuICAgICAgdGhpcy5wcm9wcy5vbkRyYXdlclN0YXRlQ2hhbmdlZChuZXdTdGF0ZSwgZHJhd2VyV2lsbFNob3cpO1xuICB9O1xuXG4gIF9vcGVuaW5nSGFuZGxlclN0YXRlQ2hhbmdlID0gKHsgbmF0aXZlRXZlbnQgfSkgPT4ge1xuICAgIGlmIChuYXRpdmVFdmVudC5vbGRTdGF0ZSA9PT0gU3RhdGUuQUNUSVZFKSB7XG4gICAgICB0aGlzLl9oYW5kbGVSZWxlYXNlKG5hdGl2ZUV2ZW50KTtcbiAgICB9IGVsc2UgaWYgKG5hdGl2ZUV2ZW50LnN0YXRlID09PSBTdGF0ZS5BQ1RJVkUpIHtcbiAgICAgIHRoaXMuX2VtaXRTdGF0ZUNoYW5nZWQoRFJBR0dJTkcsIGZhbHNlKTtcbiAgICAgIGlmICh0aGlzLnByb3BzLmtleWJvYXJkRGlzbWlzc01vZGUgPT09ICdvbi1kcmFnJykge1xuICAgICAgICBLZXlib2FyZC5kaXNtaXNzKCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5wcm9wcy5oaWRlU3RhdHVzQmFyKSB7XG4gICAgICAgIFN0YXR1c0Jhci5zZXRIaWRkZW4odHJ1ZSwgdGhpcy5wcm9wcy5zdGF0dXNCYXJBbmltYXRpb24gfHwgJ3NsaWRlJyk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIF9vblRhcEhhbmRsZXJTdGF0ZUNoYW5nZSA9ICh7IG5hdGl2ZUV2ZW50IH0pID0+IHtcbiAgICBpZiAoXG4gICAgICB0aGlzLl9kcmF3ZXJTaG93biAmJlxuICAgICAgbmF0aXZlRXZlbnQub2xkU3RhdGUgPT09IFN0YXRlLkFDVElWRSAmJlxuICAgICAgdGhpcy5wcm9wcy5kcmF3ZXJMb2NrTW9kZSAhPT0gJ2xvY2tlZC1vcGVuJ1xuICAgICkge1xuICAgICAgdGhpcy5jbG9zZURyYXdlcigpO1xuICAgIH1cbiAgfTtcblxuICBfaGFuZGxlUmVsZWFzZSA9IG5hdGl2ZUV2ZW50ID0+IHtcbiAgICBjb25zdCB7IGRyYXdlcldpZHRoLCBkcmF3ZXJQb3NpdGlvbiwgZHJhd2VyVHlwZSB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7IGNvbnRhaW5lcldpZHRoIH0gPSB0aGlzLnN0YXRlO1xuICAgIGxldCB7IHRyYW5zbGF0aW9uWDogZHJhZ1gsIHZlbG9jaXR5WCwgeDogdG91Y2hYIH0gPSBuYXRpdmVFdmVudDtcblxuICAgIGlmIChkcmF3ZXJQb3NpdGlvbiAhPT0gJ2xlZnQnKSB7XG4gICAgICAvLyBTZWUgZGVzY3JpcHRpb24gaW4gX3VwZGF0ZUFuaW1hdGVkRXZlbnQgYWJvdXQgd2h5IGV2ZW50cyBhcmUgZmxpcHBlZFxuICAgICAgLy8gZm9yIHJpZ2h0LXNpZGUgZHJhd2VyXG4gICAgICBkcmFnWCA9IC1kcmFnWDtcbiAgICAgIHRvdWNoWCA9IGNvbnRhaW5lcldpZHRoIC0gdG91Y2hYO1xuICAgICAgdmVsb2NpdHlYID0gLXZlbG9jaXR5WDtcbiAgICB9XG5cbiAgICBjb25zdCBnZXN0dXJlU3RhcnRYID0gdG91Y2hYIC0gZHJhZ1g7XG4gICAgbGV0IGRyYWdPZmZzZXRCYXNlZE9uU3RhcnQgPSAwO1xuXG4gICAgaWYgKGRyYXdlclR5cGUgPT09ICdmcm9udCcpIHtcbiAgICAgIGRyYWdPZmZzZXRCYXNlZE9uU3RhcnQgPVxuICAgICAgICBnZXN0dXJlU3RhcnRYID4gZHJhd2VyV2lkdGggPyBnZXN0dXJlU3RhcnRYIC0gZHJhd2VyV2lkdGggOiAwO1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXJ0T2Zmc2V0WCA9XG4gICAgICBkcmFnWCArIGRyYWdPZmZzZXRCYXNlZE9uU3RhcnQgKyAodGhpcy5fZHJhd2VyU2hvd24gPyBkcmF3ZXJXaWR0aCA6IDApO1xuICAgIGNvbnN0IHByb2pPZmZzZXRYID0gc3RhcnRPZmZzZXRYICsgRFJBR19UT1NTICogdmVsb2NpdHlYO1xuXG4gICAgY29uc3Qgc2hvdWxkT3BlbiA9IHByb2pPZmZzZXRYID4gZHJhd2VyV2lkdGggLyAyO1xuXG4gICAgaWYgKHNob3VsZE9wZW4pIHtcbiAgICAgIHRoaXMuX2FuaW1hdGVEcmF3ZXIoc3RhcnRPZmZzZXRYLCBkcmF3ZXJXaWR0aCwgdmVsb2NpdHlYKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYW5pbWF0ZURyYXdlcihzdGFydE9mZnNldFgsIDAsIHZlbG9jaXR5WCk7XG4gICAgfVxuICB9O1xuXG4gIF91cGRhdGVTaG93aW5nID0gKHNob3dpbmc6IGJvb2xlYW4pID0+IHtcbiAgICB0aGlzLl9kcmF3ZXJTaG93biA9IHNob3dpbmc7XG4gICAgdGhpcy5fYWNjZXNzaWJpbGl0eUlzTW9kYWxWaWV3LmN1cnJlbnQgJiZcbiAgICAgIHRoaXMuX2FjY2Vzc2liaWxpdHlJc01vZGFsVmlldy5jdXJyZW50LnNldE5hdGl2ZVByb3BzKHtcbiAgICAgICAgYWNjZXNzaWJpbGl0eVZpZXdJc01vZGFsOiBzaG93aW5nLFxuICAgICAgfSk7XG4gICAgdGhpcy5fcG9pbnRlckV2ZW50c1ZpZXcuY3VycmVudCAmJlxuICAgICAgdGhpcy5fcG9pbnRlckV2ZW50c1ZpZXcuY3VycmVudC5zZXROYXRpdmVQcm9wcyh7XG4gICAgICAgIHBvaW50ZXJFdmVudHM6IHNob3dpbmcgPyAnYXV0bycgOiAnbm9uZScsXG4gICAgICB9KTtcbiAgICBjb25zdCB7IGRyYXdlclBvc2l0aW9uLCBtaW5Td2lwZURpc3RhbmNlLCBlZGdlV2lkdGggfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgZnJvbUxlZnQgPSBkcmF3ZXJQb3NpdGlvbiA9PT0gJ2xlZnQnO1xuICAgIC8vIGdlc3R1cmVPcmllbnRhdGlvbiBpcyAxIGlmIHRoZSBleHBlY3RlZCBnZXN0dXJlIGlzIGZyb20gbGVmdCB0byByaWdodCBhbmQgLTEgb3RoZXJ3aXNlXG4gICAgLy8gZS5nLiB3aGVuIGRyYXdlciBpcyBvbiB0aGUgbGVmdCBhbmQgaXMgY2xvc2VkIHdlIGV4cGVjdCBsZWZ0IHRvIHJpZ2h0IGdlc3R1cmUsIHRodXNcbiAgICAvLyBvcmllbnRhdGlvbiB3aWxsIGJlIDEuXG4gICAgY29uc3QgZ2VzdHVyZU9yaWVudGF0aW9uID1cbiAgICAgIChmcm9tTGVmdCA/IDEgOiAtMSkgKiAodGhpcy5fZHJhd2VyU2hvd24gPyAtMSA6IDEpO1xuICAgIC8vIFdoZW4gZHJhd2VyIGlzIGNsb3NlZCB3ZSB3YW50IHRoZSBoaXRTbG9wIHRvIGJlIGhvcml6b250YWxseSBzaG9ydGVyXG4gICAgLy8gdGhhbiB0aGUgY29udGFpbmVyIHNpemUgYnkgdGhlIHZhbHVlIG9mIFNMT1AuIFRoaXMgd2lsbCBtYWtlIGl0IG9ubHlcbiAgICAvLyBhY3RpdmF0ZSB3aGVuIGdlc3R1cmUgaGFwcGVucyBub3QgZnVydGhlciB0aGFuIFNMT1AgYXdheSBmcm9tIHRoZSBlZGdlXG4gICAgY29uc3QgaGl0U2xvcCA9IGZyb21MZWZ0XG4gICAgICA/IHsgbGVmdDogMCwgd2lkdGg6IHNob3dpbmcgPyB1bmRlZmluZWQgOiBlZGdlV2lkdGggfVxuICAgICAgOiB7IHJpZ2h0OiAwLCB3aWR0aDogc2hvd2luZyA/IHVuZGVmaW5lZCA6IGVkZ2VXaWR0aCB9O1xuICAgIHRoaXMuX3Bhbkdlc3R1cmVIYW5kbGVyLmN1cnJlbnQgJiZcbiAgICAgIHRoaXMuX3Bhbkdlc3R1cmVIYW5kbGVyLmN1cnJlbnQuc2V0TmF0aXZlUHJvcHMoe1xuICAgICAgICBoaXRTbG9wLFxuICAgICAgICBhY3RpdmVPZmZzZXRYOiBnZXN0dXJlT3JpZW50YXRpb24gKiBtaW5Td2lwZURpc3RhbmNlLFxuICAgICAgfSk7XG4gIH07XG5cbiAgX2FuaW1hdGVEcmF3ZXIgPSAoZnJvbVZhbHVlOiA/bnVtYmVyLCB0b1ZhbHVlOiBudW1iZXIsIHZlbG9jaXR5OiBudW1iZXIpID0+IHtcbiAgICB0aGlzLnN0YXRlLmRyYWdYLnNldFZhbHVlKDApO1xuICAgIHRoaXMuc3RhdGUudG91Y2hYLnNldFZhbHVlKFxuICAgICAgdGhpcy5wcm9wcy5kcmF3ZXJQb3NpdGlvbiA9PT0gJ2xlZnQnID8gMCA6IHRoaXMuc3RhdGUuY29udGFpbmVyV2lkdGhcbiAgICApO1xuXG4gICAgaWYgKGZyb21WYWx1ZSAhPSBudWxsKSB7XG4gICAgICBsZXQgbmV4dEZyYW1lUG9zaXRpb24gPSBmcm9tVmFsdWU7XG4gICAgICBpZiAodGhpcy5wcm9wcy51c2VOYXRpdmVBbmltYXRpb25zKSB7XG4gICAgICAgIC8vIFdoZW4gdXNpbmcgbmF0aXZlIGRyaXZlciwgd2UgcHJlZGljdCB0aGUgbmV4dCBwb3NpdGlvbiBvZiB0aGUgYW5pbWF0aW9uXG4gICAgICAgIC8vIGJlY2F1c2UgaXQgdGFrZXMgb25lIGZyYW1lIG9mIGEgcm91bmR0cmlwIHRvIHBhc3MgUkVMRUFTRSBldmVudCBmcm9tXG4gICAgICAgIC8vIG5hdGl2ZSBkcml2ZXIgdG8gSlMgYmVmb3JlIHdlIGNhbiBzdGFydCBhbmltYXRpbmcuIFdpdGhvdXQgaXQsIGl0IGlzIG1vcmVcbiAgICAgICAgLy8gbm90aWNhYmxlIHRoYXQgdGhlIGZyYW1lIGlzIGRyb3BwZWQuXG4gICAgICAgIGlmIChmcm9tVmFsdWUgPCB0b1ZhbHVlICYmIHZlbG9jaXR5ID4gMCkge1xuICAgICAgICAgIG5leHRGcmFtZVBvc2l0aW9uID0gTWF0aC5taW4oZnJvbVZhbHVlICsgdmVsb2NpdHkgLyA2MC4wLCB0b1ZhbHVlKTtcbiAgICAgICAgfSBlbHNlIGlmIChmcm9tVmFsdWUgPiB0b1ZhbHVlICYmIHZlbG9jaXR5IDwgMCkge1xuICAgICAgICAgIG5leHRGcmFtZVBvc2l0aW9uID0gTWF0aC5tYXgoZnJvbVZhbHVlICsgdmVsb2NpdHkgLyA2MC4wLCB0b1ZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5zdGF0ZS5kcmF3ZXJUcmFuc2xhdGlvbi5zZXRWYWx1ZShuZXh0RnJhbWVQb3NpdGlvbik7XG4gICAgfVxuXG4gICAgY29uc3Qgd2lsbFNob3cgPSB0b1ZhbHVlICE9PSAwO1xuICAgIHRoaXMuX3VwZGF0ZVNob3dpbmcod2lsbFNob3cpO1xuICAgIHRoaXMuX2VtaXRTdGF0ZUNoYW5nZWQoU0VUVExJTkcsIHdpbGxTaG93KTtcbiAgICBpZiAodGhpcy5wcm9wcy5oaWRlU3RhdHVzQmFyKSB7XG4gICAgICBTdGF0dXNCYXIuc2V0SGlkZGVuKHdpbGxTaG93LCB0aGlzLnByb3BzLnN0YXR1c0JhckFuaW1hdGlvbiB8fCAnc2xpZGUnKTtcbiAgICB9XG4gICAgQW5pbWF0ZWQuc3ByaW5nKHRoaXMuc3RhdGUuZHJhd2VyVHJhbnNsYXRpb24sIHtcbiAgICAgIHZlbG9jaXR5LFxuICAgICAgYm91bmNpbmVzczogMCxcbiAgICAgIHRvVmFsdWUsXG4gICAgICB1c2VOYXRpdmVEcml2ZXI6IHRoaXMucHJvcHMudXNlTmF0aXZlQW5pbWF0aW9ucyxcbiAgICB9KS5zdGFydCgoeyBmaW5pc2hlZCB9KSA9PiB7XG4gICAgICBpZiAoZmluaXNoZWQpIHtcbiAgICAgICAgdGhpcy5fZW1pdFN0YXRlQ2hhbmdlZChJRExFLCB3aWxsU2hvdyk7XG4gICAgICAgIGlmICh3aWxsU2hvdykge1xuICAgICAgICAgIHRoaXMucHJvcHMub25EcmF3ZXJPcGVuICYmIHRoaXMucHJvcHMub25EcmF3ZXJPcGVuKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5wcm9wcy5vbkRyYXdlckNsb3NlICYmIHRoaXMucHJvcHMub25EcmF3ZXJDbG9zZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgb3BlbkRyYXdlciA9IChvcHRpb25zOiBEcmF3ZXJNb3ZlbWVudE9wdGlvblR5cGUgPSB7fSkgPT4ge1xuICAgIHRoaXMuX2FuaW1hdGVEcmF3ZXIoXG4gICAgICB1bmRlZmluZWQsXG4gICAgICB0aGlzLnByb3BzLmRyYXdlcldpZHRoLFxuICAgICAgb3B0aW9ucy52ZWxvY2l0eSA/IG9wdGlvbnMudmVsb2NpdHkgOiAwXG4gICAgKTtcblxuICAgIC8vIFdlIG5lZWQgdG8gZm9yY2UgdGhlIHVwZGF0ZSwgb3RoZXJ3aXNlIHRoZSBvdmVybGF5IGlzIG5vdCByZXJlbmRlcmVkIGFuZCBpdCB3b3VsZCBub3QgYmUgY2xpY2thYmxlXG4gICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICB9O1xuXG4gIGNsb3NlRHJhd2VyID0gKG9wdGlvbnM6IERyYXdlck1vdmVtZW50T3B0aW9uVHlwZSA9IHt9KSA9PiB7XG4gICAgdGhpcy5fYW5pbWF0ZURyYXdlcih1bmRlZmluZWQsIDAsIG9wdGlvbnMudmVsb2NpdHkgPyBvcHRpb25zLnZlbG9jaXR5IDogMCk7XG5cbiAgICAvLyBXZSBuZWVkIHRvIGZvcmNlIHRoZSB1cGRhdGUsIG90aGVyd2lzZSB0aGUgb3ZlcmxheSBpcyBub3QgcmVyZW5kZXJlZCBhbmQgaXQgd291bGQgYmUgc3RpbGwgY2xpY2thYmxlXG4gICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICB9O1xuXG4gIF9yZW5kZXJPdmVybGF5ID0gKCkgPT4ge1xuICAgIC8qIE92ZXJsYXkgc3R5bGVzICovXG4gICAgaW52YXJpYW50KHRoaXMuX29wZW5WYWx1ZSwgJ3Nob3VsZCBiZSBzZXQnKTtcbiAgICBjb25zdCBvdmVybGF5T3BhY2l0eSA9IHRoaXMuX29wZW5WYWx1ZS5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICBvdXRwdXRSYW5nZTogWzAsIDFdLFxuICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgfSk7XG4gICAgY29uc3QgZHluYW1pY092ZXJsYXlTdHlsZXMgPSB7XG4gICAgICBvcGFjaXR5OiBvdmVybGF5T3BhY2l0eSxcbiAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5wcm9wcy5vdmVybGF5Q29sb3IsXG4gICAgfTtcblxuICAgIHJldHVybiAoXG4gICAgICA8VGFwR2VzdHVyZUhhbmRsZXIgb25IYW5kbGVyU3RhdGVDaGFuZ2U9e3RoaXMuX29uVGFwSGFuZGxlclN0YXRlQ2hhbmdlfT5cbiAgICAgICAgPEFuaW1hdGVkLlZpZXdcbiAgICAgICAgICBwb2ludGVyRXZlbnRzPXt0aGlzLl9kcmF3ZXJTaG93biA/ICdhdXRvJyA6ICdub25lJ31cbiAgICAgICAgICByZWY9e3RoaXMuX3BvaW50ZXJFdmVudHNWaWV3fVxuICAgICAgICAgIHN0eWxlPXtbc3R5bGVzLm92ZXJsYXksIGR5bmFtaWNPdmVybGF5U3R5bGVzXX1cbiAgICAgICAgLz5cbiAgICAgIDwvVGFwR2VzdHVyZUhhbmRsZXI+XG4gICAgKTtcbiAgfTtcblxuICBfcmVuZGVyRHJhd2VyID0gKCkgPT4ge1xuICAgIGNvbnN0IHtcbiAgICAgIGRyYXdlckJhY2tncm91bmRDb2xvcixcbiAgICAgIGRyYXdlcldpZHRoLFxuICAgICAgZHJhd2VyUG9zaXRpb24sXG4gICAgICBkcmF3ZXJUeXBlLFxuICAgICAgZHJhd2VyQ29udGFpbmVyU3R5bGUsXG4gICAgICBjb250ZW50Q29udGFpbmVyU3R5bGUsXG4gICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICBjb25zdCBmcm9tTGVmdCA9IGRyYXdlclBvc2l0aW9uID09PSAnbGVmdCc7XG4gICAgY29uc3QgZHJhd2VyU2xpZGUgPSBkcmF3ZXJUeXBlICE9PSAnYmFjayc7XG4gICAgY29uc3QgY29udGFpbmVyU2xpZGUgPSBkcmF3ZXJUeXBlICE9PSAnZnJvbnQnO1xuXG4gICAgLy8gd2UgcmVseSBvbiByb3cgYW5kIHJvdy1yZXZlcnNlIGZsZXggZGlyZWN0aW9ucyB0byBwb3NpdGlvbiB0aGUgZHJhd2VyXG4gICAgLy8gcHJvcGVybHkuIEFwcGFyZW50bHkgZm9yIFJUTCB0aGVzZSBhcmUgZmxpcHBlZCB3aGljaCByZXF1aXJlcyB1cyB0byB1c2VcbiAgICAvLyB0aGUgb3Bwb3NpdGUgc2V0dGluZyBmb3IgdGhlIGRyYXdlciB0byBhcHBlYXIgZnJvbSBsZWZ0IG9yIHJpZ2h0IGFjY29yZGluZ1xuICAgIC8vIHRvIHRoZSBkcmF3ZXJQb3NpdGlvbiBwcm9wXG4gICAgY29uc3QgcmV2ZXJzZUNvbnRlbnREaXJlY3Rpb24gPSBJMThuTWFuYWdlci5pc1JUTCA/IGZyb21MZWZ0IDogIWZyb21MZWZ0O1xuXG4gICAgY29uc3QgZHluYW1pY0RyYXdlclN0eWxlcyA9IHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogZHJhd2VyQmFja2dyb3VuZENvbG9yLFxuICAgICAgd2lkdGg6IGRyYXdlcldpZHRoLFxuICAgIH07XG4gICAgY29uc3Qgb3BlblZhbHVlID0gdGhpcy5fb3BlblZhbHVlO1xuICAgIGludmFyaWFudChvcGVuVmFsdWUsICdzaG91bGQgYmUgc2V0Jyk7XG5cbiAgICBsZXQgY29udGFpbmVyU3R5bGVzO1xuICAgIGlmIChjb250YWluZXJTbGlkZSkge1xuICAgICAgY29uc3QgY29udGFpbmVyVHJhbnNsYXRlWCA9IG9wZW5WYWx1ZS5pbnRlcnBvbGF0ZSh7XG4gICAgICAgIGlucHV0UmFuZ2U6IFswLCAxXSxcbiAgICAgICAgb3V0cHV0UmFuZ2U6IGZyb21MZWZ0ID8gWzAsIGRyYXdlcldpZHRoXSA6IFswLCAtZHJhd2VyV2lkdGhdLFxuICAgICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICAgIH0pO1xuICAgICAgY29udGFpbmVyU3R5bGVzID0ge1xuICAgICAgICB0cmFuc2Zvcm06IFt7IHRyYW5zbGF0ZVg6IGNvbnRhaW5lclRyYW5zbGF0ZVggfV0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIGxldCBkcmF3ZXJUcmFuc2xhdGVYID0gMDtcbiAgICBpZiAoZHJhd2VyU2xpZGUpIHtcbiAgICAgIGNvbnN0IGNsb3NlZERyYXdlck9mZnNldCA9IGZyb21MZWZ0ID8gLWRyYXdlcldpZHRoIDogZHJhd2VyV2lkdGg7XG4gICAgICBkcmF3ZXJUcmFuc2xhdGVYID0gb3BlblZhbHVlLmludGVycG9sYXRlKHtcbiAgICAgICAgaW5wdXRSYW5nZTogWzAsIDFdLFxuICAgICAgICBvdXRwdXRSYW5nZTogW2Nsb3NlZERyYXdlck9mZnNldCwgMF0sXG4gICAgICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGRyYXdlclN0eWxlcyA9IHtcbiAgICAgIHRyYW5zZm9ybTogW3sgdHJhbnNsYXRlWDogZHJhd2VyVHJhbnNsYXRlWCB9XSxcbiAgICAgIGZsZXhEaXJlY3Rpb246IHJldmVyc2VDb250ZW50RGlyZWN0aW9uID8gJ3Jvdy1yZXZlcnNlJyA6ICdyb3cnLFxuICAgIH07XG5cbiAgICByZXR1cm4gKFxuICAgICAgPEFuaW1hdGVkLlZpZXcgc3R5bGU9e3N0eWxlcy5tYWlufSBvbkxheW91dD17dGhpcy5faGFuZGxlQ29udGFpbmVyTGF5b3V0fT5cbiAgICAgICAgPEFuaW1hdGVkLlZpZXdcbiAgICAgICAgICBzdHlsZT17W1xuICAgICAgICAgICAgZHJhd2VyVHlwZSA9PT0gJ2Zyb250J1xuICAgICAgICAgICAgICA/IHN0eWxlcy5jb250YWluZXJPbkJhY2tcbiAgICAgICAgICAgICAgOiBzdHlsZXMuY29udGFpbmVySW5Gcm9udCxcbiAgICAgICAgICAgIGNvbnRhaW5lclN0eWxlcyxcbiAgICAgICAgICAgIGNvbnRlbnRDb250YWluZXJTdHlsZSxcbiAgICAgICAgICBdfVxuICAgICAgICAgIGltcG9ydGFudEZvckFjY2Vzc2liaWxpdHk9e1xuICAgICAgICAgICAgdGhpcy5fZHJhd2VyU2hvd24gPyAnbm8taGlkZS1kZXNjZW5kYW50cycgOiAneWVzJ1xuICAgICAgICAgIH0+XG4gICAgICAgICAge3R5cGVvZiB0aGlzLnByb3BzLmNoaWxkcmVuID09PSAnZnVuY3Rpb24nXG4gICAgICAgICAgICA/IHRoaXMucHJvcHMuY2hpbGRyZW4odGhpcy5fb3BlblZhbHVlKVxuICAgICAgICAgICAgOiB0aGlzLnByb3BzLmNoaWxkcmVufVxuICAgICAgICAgIHt0aGlzLl9yZW5kZXJPdmVybGF5KCl9XG4gICAgICAgIDwvQW5pbWF0ZWQuVmlldz5cbiAgICAgICAgPEFuaW1hdGVkLlZpZXdcbiAgICAgICAgICBwb2ludGVyRXZlbnRzPVwiYm94LW5vbmVcIlxuICAgICAgICAgIHJlZj17dGhpcy5fYWNjZXNzaWJpbGl0eUlzTW9kYWxWaWV3fVxuICAgICAgICAgIGFjY2Vzc2liaWxpdHlWaWV3SXNNb2RhbD17dGhpcy5fZHJhd2VyU2hvd259XG4gICAgICAgICAgc3R5bGU9e1tzdHlsZXMuZHJhd2VyQ29udGFpbmVyLCBkcmF3ZXJTdHlsZXMsIGRyYXdlckNvbnRhaW5lclN0eWxlXX0+XG4gICAgICAgICAgPFZpZXcgc3R5bGU9e2R5bmFtaWNEcmF3ZXJTdHlsZXN9PlxuICAgICAgICAgICAge3RoaXMucHJvcHMucmVuZGVyTmF2aWdhdGlvblZpZXcodGhpcy5fb3BlblZhbHVlKX1cbiAgICAgICAgICA8L1ZpZXc+XG4gICAgICAgIDwvQW5pbWF0ZWQuVmlldz5cbiAgICAgIDwvQW5pbWF0ZWQuVmlldz5cbiAgICApO1xuICB9O1xuXG4gIF9zZXRQYW5HZXN0dXJlUmVmID0gcmVmID0+IHtcbiAgICB0aGlzLl9wYW5HZXN0dXJlSGFuZGxlci5jdXJyZW50ID0gcmVmO1xuICAgIHRoaXMucHJvcHMub25HZXN0dXJlUmVmICYmIHRoaXMucHJvcHMub25HZXN0dXJlUmVmKHJlZik7XG4gIH07XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIGRyYXdlclBvc2l0aW9uLFxuICAgICAgZHJhd2VyTG9ja01vZGUsXG4gICAgICBlZGdlV2lkdGgsXG4gICAgICBtaW5Td2lwZURpc3RhbmNlLFxuICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgY29uc3QgZnJvbUxlZnQgPSBkcmF3ZXJQb3NpdGlvbiA9PT0gJ2xlZnQnO1xuXG4gICAgLy8gZ2VzdHVyZU9yaWVudGF0aW9uIGlzIDEgaWYgdGhlIGV4cGVjdGVkIGdlc3R1cmUgaXMgZnJvbSBsZWZ0IHRvIHJpZ2h0IGFuZCAtMSBvdGhlcndpc2VcbiAgICAvLyBlLmcuIHdoZW4gZHJhd2VyIGlzIG9uIHRoZSBsZWZ0IGFuZCBpcyBjbG9zZWQgd2UgZXhwZWN0IGxlZnQgdG8gcmlnaHQgZ2VzdHVyZSwgdGh1c1xuICAgIC8vIG9yaWVudGF0aW9uIHdpbGwgYmUgMS5cbiAgICBjb25zdCBnZXN0dXJlT3JpZW50YXRpb24gPVxuICAgICAgKGZyb21MZWZ0ID8gMSA6IC0xKSAqICh0aGlzLl9kcmF3ZXJTaG93biA/IC0xIDogMSk7XG5cbiAgICAvLyBXaGVuIGRyYXdlciBpcyBjbG9zZWQgd2Ugd2FudCB0aGUgaGl0U2xvcCB0byBiZSBob3Jpem9udGFsbHkgc2hvcnRlclxuICAgIC8vIHRoYW4gdGhlIGNvbnRhaW5lciBzaXplIGJ5IHRoZSB2YWx1ZSBvZiBTTE9QLiBUaGlzIHdpbGwgbWFrZSBpdCBvbmx5XG4gICAgLy8gYWN0aXZhdGUgd2hlbiBnZXN0dXJlIGhhcHBlbnMgbm90IGZ1cnRoZXIgdGhhbiBTTE9QIGF3YXkgZnJvbSB0aGUgZWRnZVxuICAgIGNvbnN0IGhpdFNsb3AgPSBmcm9tTGVmdFxuICAgICAgPyB7IGxlZnQ6IDAsIHdpZHRoOiB0aGlzLl9kcmF3ZXJTaG93biA/IHVuZGVmaW5lZCA6IGVkZ2VXaWR0aCB9XG4gICAgICA6IHsgcmlnaHQ6IDAsIHdpZHRoOiB0aGlzLl9kcmF3ZXJTaG93biA/IHVuZGVmaW5lZCA6IGVkZ2VXaWR0aCB9O1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxQYW5HZXN0dXJlSGFuZGxlclxuICAgICAgICByZWY9e3RoaXMuX3NldFBhbkdlc3R1cmVSZWZ9XG4gICAgICAgIGhpdFNsb3A9e2hpdFNsb3B9XG4gICAgICAgIGFjdGl2ZU9mZnNldFg9e2dlc3R1cmVPcmllbnRhdGlvbiAqIG1pblN3aXBlRGlzdGFuY2V9XG4gICAgICAgIGZhaWxPZmZzZXRZPXtbLTE1LCAxNV19XG4gICAgICAgIG9uR2VzdHVyZUV2ZW50PXt0aGlzLl9vbkdlc3R1cmVFdmVudH1cbiAgICAgICAgb25IYW5kbGVyU3RhdGVDaGFuZ2U9e3RoaXMuX29wZW5pbmdIYW5kbGVyU3RhdGVDaGFuZ2V9XG4gICAgICAgIGVuYWJsZWQ9e1xuICAgICAgICAgIGRyYXdlckxvY2tNb2RlICE9PSAnbG9ja2VkLWNsb3NlZCcgJiYgZHJhd2VyTG9ja01vZGUgIT09ICdsb2NrZWQtb3BlbidcbiAgICAgICAgfT5cbiAgICAgICAge3RoaXMuX3JlbmRlckRyYXdlcigpfVxuICAgICAgPC9QYW5HZXN0dXJlSGFuZGxlcj5cbiAgICApO1xuICB9XG59XG5cbmNvbnN0IHN0eWxlcyA9IFN0eWxlU2hlZXQuY3JlYXRlKHtcbiAgZHJhd2VyQ29udGFpbmVyOiB7XG4gICAgLi4uU3R5bGVTaGVldC5hYnNvbHV0ZUZpbGxPYmplY3QsXG4gICAgekluZGV4OiAxMDAxLFxuICAgIGZsZXhEaXJlY3Rpb246ICdyb3cnLFxuICB9LFxuICBjb250YWluZXJJbkZyb250OiB7XG4gICAgLi4uU3R5bGVTaGVldC5hYnNvbHV0ZUZpbGxPYmplY3QsXG4gICAgekluZGV4OiAxMDAyLFxuICB9LFxuICBjb250YWluZXJPbkJhY2s6IHtcbiAgICAuLi5TdHlsZVNoZWV0LmFic29sdXRlRmlsbE9iamVjdCxcbiAgfSxcbiAgbWFpbjoge1xuICAgIGZsZXg6IDEsXG4gICAgekluZGV4OiAwLFxuICAgIG92ZXJmbG93OiAnaGlkZGVuJyxcbiAgfSxcbiAgb3ZlcmxheToge1xuICAgIC4uLlN0eWxlU2hlZXQuYWJzb2x1dGVGaWxsT2JqZWN0LFxuICAgIHpJbmRleDogMTAwMCxcbiAgfSxcbn0pO1xuIl19