250e7b70a4fefc2d8b1feb74bb6bba7e
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.RotationGestureHandler = exports.PinchGestureHandler = exports.PanGestureHandler = exports.LongPressGestureHandler = exports.ForceTouchGestureHandler = exports.FlingGestureHandler = exports.TapGestureHandler = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireDefault(require("react"));

var _createHandler = _interopRequireDefault(require("./createHandler"));

var _GestureHandlerPropTypes = _interopRequireDefault(require("./GestureHandlerPropTypes"));

var _PlatformConstants = _interopRequireDefault(require("./PlatformConstants"));

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

var TapGestureHandler = (0, _createHandler.default)('TapGestureHandler', _objectSpread(_objectSpread({}, _GestureHandlerPropTypes.default), {}, {
  maxDurationMs: _propTypes.default.number,
  maxDelayMs: _propTypes.default.number,
  numberOfTaps: _propTypes.default.number,
  maxDeltaX: _propTypes.default.number,
  maxDeltaY: _propTypes.default.number,
  maxDist: _propTypes.default.number,
  minPointers: _propTypes.default.number
}), {});
exports.TapGestureHandler = TapGestureHandler;
var FlingGestureHandler = (0, _createHandler.default)('FlingGestureHandler', _objectSpread(_objectSpread({}, _GestureHandlerPropTypes.default), {}, {
  numberOfPointers: _propTypes.default.number,
  direction: _propTypes.default.number
}), {});
exports.FlingGestureHandler = FlingGestureHandler;

var ForceTouchFallback = function (_React$Component) {
  (0, _inherits2.default)(ForceTouchFallback, _React$Component);

  var _super = _createSuper(ForceTouchFallback);

  function ForceTouchFallback() {
    (0, _classCallCheck2.default)(this, ForceTouchFallback);
    return _super.apply(this, arguments);
  }

  (0, _createClass2.default)(ForceTouchFallback, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      console.warn('ForceTouchGestureHandler is not available on this platform. Please use ForceTouchGestureHandler.forceTouchAvailable to conditionally render other components that would provide a fallback behavior specific to your usecase');
    }
  }, {
    key: "render",
    value: function render() {
      return this.props.children;
    }
  }]);
  return ForceTouchFallback;
}(_react.default.Component);

var ForceTouchGestureHandler = _PlatformConstants.default && _PlatformConstants.default.forceTouchAvailable ? (0, _createHandler.default)('ForceTouchGestureHandler', _objectSpread(_objectSpread({}, _GestureHandlerPropTypes.default), {}, {
  minForce: _propTypes.default.number,
  maxForce: _propTypes.default.number,
  feedbackOnActivation: _propTypes.default.bool
}), {}) : ForceTouchFallback;
exports.ForceTouchGestureHandler = ForceTouchGestureHandler;
ForceTouchGestureHandler.forceTouchAvailable = _PlatformConstants.default && _PlatformConstants.default.forceTouchAvailable || false;
var LongPressGestureHandler = (0, _createHandler.default)('LongPressGestureHandler', _objectSpread(_objectSpread({}, _GestureHandlerPropTypes.default), {}, {
  minDurationMs: _propTypes.default.number,
  maxDist: _propTypes.default.number
}), {});
exports.LongPressGestureHandler = LongPressGestureHandler;

function validatePanGestureHandlerProps(props) {
  if (props.minDeltaX && props.activeOffsetX) {
    throw new Error("It's not supported use minDeltaX with activeOffsetXStart or activeOffsetXEnd");
  }

  if (props.maxDeltaX && props.failOffsetX) {
    throw new Error("It's not supported use minDeltaX with activeOffsetXStart or activeOffsetXEnd");
  }

  if (props.minDeltaY && props.activeOffsetY) {
    throw new Error("It's not supported use minDeltaX with activeOffsetYStart or activeOffsetYEnd");
  }

  if (props.maxDeltaY && props.failOffsetY) {
    throw new Error("It's not supported use minDeltaX with activeOffsetYStart or activeOffsetYEnd");
  }

  if (Array.isArray(props.activeOffsetX) && (props.activeOffsetX[0] > 0 || props.activeOffsetX[1] < 0)) {
    throw new Error("First element of activeOffsetX should be negative, a the second one should be positive");
  }

  if (Array.isArray(props.activeOffsetY) && (props.activeOffsetY[0] > 0 || props.activeOffsetY[1] < 0)) {
    throw new Error("First element of activeOffsetY should be negative, a the second one should be positive");
  }

  if (Array.isArray(props.failOffsetX) && (props.failOffsetX[0] > 0 || props.failOffsetX[1] < 0)) {
    throw new Error("First element of failOffsetX should be negative, a the second one should be positive");
  }

  if (Array.isArray(props.failOffsetY) && (props.failOffsetY[0] > 0 || props.failOffsetY[1] < 0)) {
    throw new Error("First element of failOffsetY should be negative, a the second one should be positive");
  }
}

function transformPanGestureHandlerProps(props) {
  var res = _objectSpread({}, props);

  if (props.minDeltaX !== undefined) {
    delete res['minDeltaX'];
    res.activeOffsetXStart = -props.minDeltaX;
    res.activeOffsetXEnd = props.minDeltaX;
  }

  if (props.maxDeltaX !== undefined) {
    delete res['maxDeltaX'];
    res.failOffsetXStart = -props.maxDeltaX;
    res.failOffsetXEnd = props.maxDeltaX;
  }

  if (props.minOffsetX !== undefined) {
    delete res['minOffsetX'];

    if (props.minOffsetX < 0) {
      res.activeOffsetXStart = props.minOffsetX;
    } else {
      res.activeOffsetXEnd = props.minOffsetX;
    }
  }

  if (props.minDeltaY !== undefined) {
    delete res['minDeltaY'];
    res.activeOffsetYStart = -props.minDeltaY;
    res.activeOffsetYEnd = props.minDeltaY;
  }

  if (props.maxDeltaY !== undefined) {
    delete res['maxDeltaY'];
    res.failOffsetYStart = -props.maxDeltaY;
    res.failOffsetYEnd = props.maxDeltaY;
  }

  if (props.minOffsetY !== undefined) {
    delete res['minOffsetY'];

    if (props.minOffsetY < 0) {
      res.activeOffsetYStart = props.minOffsetY;
    } else {
      res.activeOffsetYEnd = props.minOffsetY;
    }
  }

  if (props.activeOffsetX !== undefined) {
    delete res['activeOffsetX'];

    if (Array.isArray(props.activeOffsetX)) {
      res.activeOffsetXStart = props.activeOffsetX[0];
      res.activeOffsetXEnd = props.activeOffsetX[1];
    } else if (props.activeOffsetX < 0) {
      res.activeOffsetXStart = props.activeOffsetX;
    } else {
      res.activeOffsetXEnd = props.activeOffsetX;
    }
  }

  if (props.activeOffsetY !== undefined) {
    delete res['activeOffsetY'];

    if (Array.isArray(props.activeOffsetY)) {
      res.activeOffsetYStart = props.activeOffsetY[0];
      res.activeOffsetYEnd = props.activeOffsetY[1];
    } else if (props.activeOffsetY < 0) {
      res.activeOffsetYStart = props.activeOffsetY;
    } else {
      res.activeOffsetYEnd = props.activeOffsetY;
    }
  }

  if (props.failOffsetX !== undefined) {
    delete res['failOffsetX'];

    if (Array.isArray(props.failOffsetX)) {
      res.failOffsetXStart = props.failOffsetX[0];
      res.failOffsetXEnd = props.failOffsetX[1];
    } else if (props.failOffsetX < 0) {
      res.failOffsetXStart = props.failOffsetX;
    } else {
      res.failOffsetXEnd = props.failOffsetX;
    }
  }

  if (props.failOffsetY !== undefined) {
    delete res['failOffsetY'];

    if (Array.isArray(props.failOffsetY)) {
      res.failOffsetYStart = props.failOffsetY[0];
      res.failOffsetYEnd = props.failOffsetY[1];
    } else if (props.failOffsetY < 0) {
      res.failOffsetYStart = props.failOffsetY;
    } else {
      res.failOffsetYEnd = props.failOffsetY;
    }
  }

  return res;
}

function managePanProps(props) {
  if (__DEV__) {
    validatePanGestureHandlerProps(props);
  }

  return transformPanGestureHandlerProps(props);
}

var PanGestureHandler = (0, _createHandler.default)('PanGestureHandler', _objectSpread(_objectSpread({}, _GestureHandlerPropTypes.default), {}, {
  activeOffsetY: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.arrayOf(_propTypes.default.number)]),
  activeOffsetX: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.arrayOf(_propTypes.default.number)]),
  failOffsetY: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.arrayOf(_propTypes.default.number)]),
  failOffsetX: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.arrayOf(_propTypes.default.number)]),
  minDist: _propTypes.default.number,
  minVelocity: _propTypes.default.number,
  minVelocityX: _propTypes.default.number,
  minVelocityY: _propTypes.default.number,
  minPointers: _propTypes.default.number,
  maxPointers: _propTypes.default.number,
  avgTouches: _propTypes.default.bool
}), {}, managePanProps, {
  activeOffsetYStart: true,
  activeOffsetYEnd: true,
  activeOffsetXStart: true,
  activeOffsetXEnd: true,
  failOffsetYStart: true,
  failOffsetYEnd: true,
  failOffsetXStart: true,
  failOffsetXEnd: true
});
exports.PanGestureHandler = PanGestureHandler;
var PinchGestureHandler = (0, _createHandler.default)('PinchGestureHandler', _GestureHandlerPropTypes.default, {});
exports.PinchGestureHandler = PinchGestureHandler;
var RotationGestureHandler = (0, _createHandler.default)('RotationGestureHandler', _GestureHandlerPropTypes.default, {});
exports.RotationGestureHandler = RotationGestureHandler;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkdlc3R1cmVzLmpzIl0sIm5hbWVzIjpbIlRhcEdlc3R1cmVIYW5kbGVyIiwiR2VzdHVyZUhhbmRsZXJQcm9wVHlwZXMiLCJtYXhEdXJhdGlvbk1zIiwiUHJvcFR5cGVzIiwibnVtYmVyIiwibWF4RGVsYXlNcyIsIm51bWJlck9mVGFwcyIsIm1heERlbHRhWCIsIm1heERlbHRhWSIsIm1heERpc3QiLCJtaW5Qb2ludGVycyIsIkZsaW5nR2VzdHVyZUhhbmRsZXIiLCJudW1iZXJPZlBvaW50ZXJzIiwiZGlyZWN0aW9uIiwiRm9yY2VUb3VjaEZhbGxiYWNrIiwiY29uc29sZSIsIndhcm4iLCJwcm9wcyIsImNoaWxkcmVuIiwiUmVhY3QiLCJDb21wb25lbnQiLCJGb3JjZVRvdWNoR2VzdHVyZUhhbmRsZXIiLCJQbGF0Zm9ybUNvbnN0YW50cyIsImZvcmNlVG91Y2hBdmFpbGFibGUiLCJtaW5Gb3JjZSIsIm1heEZvcmNlIiwiZmVlZGJhY2tPbkFjdGl2YXRpb24iLCJib29sIiwiTG9uZ1ByZXNzR2VzdHVyZUhhbmRsZXIiLCJtaW5EdXJhdGlvbk1zIiwidmFsaWRhdGVQYW5HZXN0dXJlSGFuZGxlclByb3BzIiwibWluRGVsdGFYIiwiYWN0aXZlT2Zmc2V0WCIsIkVycm9yIiwiZmFpbE9mZnNldFgiLCJtaW5EZWx0YVkiLCJhY3RpdmVPZmZzZXRZIiwiZmFpbE9mZnNldFkiLCJBcnJheSIsImlzQXJyYXkiLCJ0cmFuc2Zvcm1QYW5HZXN0dXJlSGFuZGxlclByb3BzIiwicmVzIiwidW5kZWZpbmVkIiwiYWN0aXZlT2Zmc2V0WFN0YXJ0IiwiYWN0aXZlT2Zmc2V0WEVuZCIsImZhaWxPZmZzZXRYU3RhcnQiLCJmYWlsT2Zmc2V0WEVuZCIsIm1pbk9mZnNldFgiLCJhY3RpdmVPZmZzZXRZU3RhcnQiLCJhY3RpdmVPZmZzZXRZRW5kIiwiZmFpbE9mZnNldFlTdGFydCIsImZhaWxPZmZzZXRZRW5kIiwibWluT2Zmc2V0WSIsIm1hbmFnZVBhblByb3BzIiwiX19ERVZfXyIsIlBhbkdlc3R1cmVIYW5kbGVyIiwib25lT2ZUeXBlIiwiYXJyYXlPZiIsIm1pbkRpc3QiLCJtaW5WZWxvY2l0eSIsIm1pblZlbG9jaXR5WCIsIm1pblZlbG9jaXR5WSIsIm1heFBvaW50ZXJzIiwiYXZnVG91Y2hlcyIsIlBpbmNoR2VzdHVyZUhhbmRsZXIiLCJSb3RhdGlvbkdlc3R1cmVIYW5kbGVyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7QUFFTyxJQUFNQSxpQkFBaUIsR0FBRyw0QkFDL0IsbUJBRCtCLGtDQUcxQkMsZ0NBSDBCO0FBSTdCQyxFQUFBQSxhQUFhLEVBQUVDLG1CQUFVQyxNQUpJO0FBSzdCQyxFQUFBQSxVQUFVLEVBQUVGLG1CQUFVQyxNQUxPO0FBTTdCRSxFQUFBQSxZQUFZLEVBQUVILG1CQUFVQyxNQU5LO0FBTzdCRyxFQUFBQSxTQUFTLEVBQUVKLG1CQUFVQyxNQVBRO0FBUTdCSSxFQUFBQSxTQUFTLEVBQUVMLG1CQUFVQyxNQVJRO0FBUzdCSyxFQUFBQSxPQUFPLEVBQUVOLG1CQUFVQyxNQVRVO0FBVTdCTSxFQUFBQSxXQUFXLEVBQUVQLG1CQUFVQztBQVZNLElBWS9CLEVBWitCLENBQTFCOztBQWVBLElBQU1PLG1CQUFtQixHQUFHLDRCQUNqQyxxQkFEaUMsa0NBRzVCVixnQ0FINEI7QUFJL0JXLEVBQUFBLGdCQUFnQixFQUFFVCxtQkFBVUMsTUFKRztBQUsvQlMsRUFBQUEsU0FBUyxFQUFFVixtQkFBVUM7QUFMVSxJQU9qQyxFQVBpQyxDQUE1Qjs7O0lBVURVLGtCOzs7Ozs7Ozs7Ozs7d0NBQ2dCO0FBQ2xCQyxNQUFBQSxPQUFPLENBQUNDLElBQVIsQ0FDRSw4TkFERjtBQUdEOzs7NkJBQ1E7QUFDUCxhQUFPLEtBQUtDLEtBQUwsQ0FBV0MsUUFBbEI7QUFDRDs7O0VBUjhCQyxlQUFNQyxTOztBQVdoQyxJQUFNQyx3QkFBd0IsR0FDbkNDLDhCQUFxQkEsMkJBQWtCQyxtQkFBdkMsR0FDSSw0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SG9DLENBQS9CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmltcG9ydCBjcmVhdGVIYW5kbGVyIGZyb20gJy4vY3JlYXRlSGFuZGxlcic7XG5pbXBvcnQgR2VzdHVyZUhhbmRsZXJQcm9wVHlwZXMgZnJvbSAnLi9HZXN0dXJlSGFuZGxlclByb3BUeXBlcyc7XG5pbXBvcnQgUGxhdGZvcm1Db25zdGFudHMgZnJvbSAnLi9QbGF0Zm9ybUNvbnN0YW50cyc7XG5cbmV4cG9ydCBjb25zdCBUYXBHZXN0dXJlSGFuZGxlciA9IGNyZWF0ZUhhbmRsZXIoXG4gICdUYXBHZXN0dXJlSGFuZGxlcicsXG4gIHtcbiAgICAuLi5HZXN0dXJlSGFuZGxlclByb3BUeXBlcyxcbiAgICBtYXhEdXJhdGlvbk1zOiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIG1heERlbGF5TXM6IFByb3BUeXBlcy5udW1iZXIsXG4gICAgbnVtYmVyT2ZUYXBzOiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIG1heERlbHRhWDogUHJvcFR5cGVzLm51bWJlcixcbiAgICBtYXhEZWx0YVk6IFByb3BUeXBlcy5udW1iZXIsXG4gICAgbWF4RGlzdDogUHJvcFR5cGVzLm51bWJlcixcbiAgICBtaW5Qb2ludGVyczogUHJvcFR5cGVzLm51bWJlcixcbiAgfSxcbiAge31cbik7XG5cbmV4cG9ydCBjb25zdCBGbGluZ0dlc3R1cmVIYW5kbGVyID0gY3JlYXRlSGFuZGxlcihcbiAgJ0ZsaW5nR2VzdHVyZUhhbmRsZXInLFxuICB7XG4gICAgLi4uR2VzdHVyZUhhbmRsZXJQcm9wVHlwZXMsXG4gICAgbnVtYmVyT2ZQb2ludGVyczogUHJvcFR5cGVzLm51bWJlcixcbiAgICBkaXJlY3Rpb246IFByb3BUeXBlcy5udW1iZXIsXG4gIH0sXG4gIHt9XG4pO1xuXG5jbGFzcyBGb3JjZVRvdWNoRmFsbGJhY2sgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICAnRm9yY2VUb3VjaEdlc3R1cmVIYW5kbGVyIGlzIG5vdCBhdmFpbGFibGUgb24gdGhpcyBwbGF0Zm9ybS4gUGxlYXNlIHVzZSBGb3JjZVRvdWNoR2VzdHVyZUhhbmRsZXIuZm9yY2VUb3VjaEF2YWlsYWJsZSB0byBjb25kaXRpb25hbGx5IHJlbmRlciBvdGhlciBjb21wb25lbnRzIHRoYXQgd291bGQgcHJvdmlkZSBhIGZhbGxiYWNrIGJlaGF2aW9yIHNwZWNpZmljIHRvIHlvdXIgdXNlY2FzZSdcbiAgICApO1xuICB9XG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5jaGlsZHJlbjtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgRm9yY2VUb3VjaEdlc3R1cmVIYW5kbGVyID1cbiAgUGxhdGZvcm1Db25zdGFudHMgJiYgUGxhdGZvcm1Db25zdGFudHMuZm9yY2VUb3VjaEF2YWlsYWJsZVxuICAgID8gY3JlYXRlSGFuZGxlcihcbiAgICAgICAgJ0ZvcmNlVG91Y2hHZXN0dXJlSGFuZGxlcicsXG4gICAgICAgIHtcbiAgICAgICAgICAuLi5HZXN0dXJlSGFuZGxlclByb3BUeXBlcyxcbiAgICAgICAgICBtaW5Gb3JjZTogUHJvcFR5cGVzLm51bWJlcixcbiAgICAgICAgICBtYXhGb3JjZTogUHJvcFR5cGVzLm51bWJlcixcbiAgICAgICAgICBmZWVkYmFja09uQWN0aXZhdGlvbjogUHJvcFR5cGVzLmJvb2wsXG4gICAgICAgIH0sXG4gICAgICAgIHt9XG4gICAgICApXG4gICAgOiBGb3JjZVRvdWNoRmFsbGJhY2s7XG5cbkZvcmNlVG91Y2hHZXN0dXJlSGFuZGxlci5mb3JjZVRvdWNoQXZhaWxhYmxlID1cbiAgKFBsYXRmb3JtQ29uc3RhbnRzICYmIFBsYXRmb3JtQ29uc3RhbnRzLmZvcmNlVG91Y2hBdmFpbGFibGUpIHx8IGZhbHNlO1xuXG5leHBvcnQgY29uc3QgTG9uZ1ByZXNzR2VzdHVyZUhhbmRsZXIgPSBjcmVhdGVIYW5kbGVyKFxuICAnTG9uZ1ByZXNzR2VzdHVyZUhhbmRsZXInLFxuICB7XG4gICAgLi4uR2VzdHVyZUhhbmRsZXJQcm9wVHlwZXMsXG4gICAgbWluRHVyYXRpb25NczogUHJvcFR5cGVzLm51bWJlcixcbiAgICBtYXhEaXN0OiBQcm9wVHlwZXMubnVtYmVyLFxuICB9LFxuICB7fVxuKTtcblxuZnVuY3Rpb24gdmFsaWRhdGVQYW5HZXN0dXJlSGFuZGxlclByb3BzKHByb3BzKSB7XG4gIGlmIChwcm9wcy5taW5EZWx0YVggJiYgcHJvcHMuYWN0aXZlT2Zmc2V0WCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBJdCdzIG5vdCBzdXBwb3J0ZWQgdXNlIG1pbkRlbHRhWCB3aXRoIGFjdGl2ZU9mZnNldFhTdGFydCBvciBhY3RpdmVPZmZzZXRYRW5kYFxuICAgICk7XG4gIH1cbiAgaWYgKHByb3BzLm1heERlbHRhWCAmJiBwcm9wcy5mYWlsT2Zmc2V0WCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBJdCdzIG5vdCBzdXBwb3J0ZWQgdXNlIG1pbkRlbHRhWCB3aXRoIGFjdGl2ZU9mZnNldFhTdGFydCBvciBhY3RpdmVPZmZzZXRYRW5kYFxuICAgICk7XG4gIH1cbiAgaWYgKHByb3BzLm1pbkRlbHRhWSAmJiBwcm9wcy5hY3RpdmVPZmZzZXRZKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYEl0J3Mgbm90IHN1cHBvcnRlZCB1c2UgbWluRGVsdGFYIHdpdGggYWN0aXZlT2Zmc2V0WVN0YXJ0IG9yIGFjdGl2ZU9mZnNldFlFbmRgXG4gICAgKTtcbiAgfVxuICBpZiAocHJvcHMubWF4RGVsdGFZICYmIHByb3BzLmZhaWxPZmZzZXRZKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYEl0J3Mgbm90IHN1cHBvcnRlZCB1c2UgbWluRGVsdGFYIHdpdGggYWN0aXZlT2Zmc2V0WVN0YXJ0IG9yIGFjdGl2ZU9mZnNldFlFbmRgXG4gICAgKTtcbiAgfVxuICBpZiAoXG4gICAgQXJyYXkuaXNBcnJheShwcm9wcy5hY3RpdmVPZmZzZXRYKSAmJlxuICAgIChwcm9wcy5hY3RpdmVPZmZzZXRYWzBdID4gMCB8fCBwcm9wcy5hY3RpdmVPZmZzZXRYWzFdIDwgMClcbiAgKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYEZpcnN0IGVsZW1lbnQgb2YgYWN0aXZlT2Zmc2V0WCBzaG91bGQgYmUgbmVnYXRpdmUsIGEgdGhlIHNlY29uZCBvbmUgc2hvdWxkIGJlIHBvc2l0aXZlYFxuICAgICk7XG4gIH1cblxuICBpZiAoXG4gICAgQXJyYXkuaXNBcnJheShwcm9wcy5hY3RpdmVPZmZzZXRZKSAmJlxuICAgIChwcm9wcy5hY3RpdmVPZmZzZXRZWzBdID4gMCB8fCBwcm9wcy5hY3RpdmVPZmZzZXRZWzFdIDwgMClcbiAgKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYEZpcnN0IGVsZW1lbnQgb2YgYWN0aXZlT2Zmc2V0WSBzaG91bGQgYmUgbmVnYXRpdmUsIGEgdGhlIHNlY29uZCBvbmUgc2hvdWxkIGJlIHBvc2l0aXZlYFxuICAgICk7XG4gIH1cblxuICBpZiAoXG4gICAgQXJyYXkuaXNBcnJheShwcm9wcy5mYWlsT2Zmc2V0WCkgJiZcbiAgICAocHJvcHMuZmFpbE9mZnNldFhbMF0gPiAwIHx8IHByb3BzLmZhaWxPZmZzZXRYWzFdIDwgMClcbiAgKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYEZpcnN0IGVsZW1lbnQgb2YgZmFpbE9mZnNldFggc2hvdWxkIGJlIG5lZ2F0aXZlLCBhIHRoZSBzZWNvbmQgb25lIHNob3VsZCBiZSBwb3NpdGl2ZWBcbiAgICApO1xuICB9XG5cbiAgaWYgKFxuICAgIEFycmF5LmlzQXJyYXkocHJvcHMuZmFpbE9mZnNldFkpICYmXG4gICAgKHByb3BzLmZhaWxPZmZzZXRZWzBdID4gMCB8fCBwcm9wcy5mYWlsT2Zmc2V0WVsxXSA8IDApXG4gICkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBGaXJzdCBlbGVtZW50IG9mIGZhaWxPZmZzZXRZIHNob3VsZCBiZSBuZWdhdGl2ZSwgYSB0aGUgc2Vjb25kIG9uZSBzaG91bGQgYmUgcG9zaXRpdmVgXG4gICAgKTtcbiAgfVxufVxuXG5mdW5jdGlvbiB0cmFuc2Zvcm1QYW5HZXN0dXJlSGFuZGxlclByb3BzKHByb3BzKSB7XG4gIGNvbnN0IHJlcyA9IHsgLi4ucHJvcHMgfTtcbiAgaWYgKHByb3BzLm1pbkRlbHRhWCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZGVsZXRlIHJlc1snbWluRGVsdGFYJ107XG4gICAgcmVzLmFjdGl2ZU9mZnNldFhTdGFydCA9IC1wcm9wcy5taW5EZWx0YVg7XG4gICAgcmVzLmFjdGl2ZU9mZnNldFhFbmQgPSBwcm9wcy5taW5EZWx0YVg7XG4gIH1cbiAgaWYgKHByb3BzLm1heERlbHRhWCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZGVsZXRlIHJlc1snbWF4RGVsdGFYJ107XG4gICAgcmVzLmZhaWxPZmZzZXRYU3RhcnQgPSAtcHJvcHMubWF4RGVsdGFYO1xuICAgIHJlcy5mYWlsT2Zmc2V0WEVuZCA9IHByb3BzLm1heERlbHRhWDtcbiAgfVxuICBpZiAocHJvcHMubWluT2Zmc2V0WCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZGVsZXRlIHJlc1snbWluT2Zmc2V0WCddO1xuICAgIGlmIChwcm9wcy5taW5PZmZzZXRYIDwgMCkge1xuICAgICAgcmVzLmFjdGl2ZU9mZnNldFhTdGFydCA9IHByb3BzLm1pbk9mZnNldFg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlcy5hY3RpdmVPZmZzZXRYRW5kID0gcHJvcHMubWluT2Zmc2V0WDtcbiAgICB9XG4gIH1cblxuICBpZiAocHJvcHMubWluRGVsdGFZICE9PSB1bmRlZmluZWQpIHtcbiAgICBkZWxldGUgcmVzWydtaW5EZWx0YVknXTtcbiAgICByZXMuYWN0aXZlT2Zmc2V0WVN0YXJ0ID0gLXByb3BzLm1pbkRlbHRhWTtcbiAgICByZXMuYWN0aXZlT2Zmc2V0WUVuZCA9IHByb3BzLm1pbkRlbHRhWTtcbiAgfVxuICBpZiAocHJvcHMubWF4RGVsdGFZICE9PSB1bmRlZmluZWQpIHtcbiAgICBkZWxldGUgcmVzWydtYXhEZWx0YVknXTtcbiAgICByZXMuZmFpbE9mZnNldFlTdGFydCA9IC1wcm9wcy5tYXhEZWx0YVk7XG4gICAgcmVzLmZhaWxPZmZzZXRZRW5kID0gcHJvcHMubWF4RGVsdGFZO1xuICB9XG5cbiAgaWYgKHByb3BzLm1pbk9mZnNldFkgIT09IHVuZGVmaW5lZCkge1xuICAgIGRlbGV0ZSByZXNbJ21pbk9mZnNldFknXTtcbiAgICBpZiAocHJvcHMubWluT2Zmc2V0WSA8IDApIHtcbiAgICAgIHJlcy5hY3RpdmVPZmZzZXRZU3RhcnQgPSBwcm9wcy5taW5PZmZzZXRZO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXMuYWN0aXZlT2Zmc2V0WUVuZCA9IHByb3BzLm1pbk9mZnNldFk7XG4gICAgfVxuICB9XG5cbiAgaWYgKHByb3BzLmFjdGl2ZU9mZnNldFggIT09IHVuZGVmaW5lZCkge1xuICAgIGRlbGV0ZSByZXNbJ2FjdGl2ZU9mZnNldFgnXTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShwcm9wcy5hY3RpdmVPZmZzZXRYKSkge1xuICAgICAgcmVzLmFjdGl2ZU9mZnNldFhTdGFydCA9IHByb3BzLmFjdGl2ZU9mZnNldFhbMF07XG4gICAgICByZXMuYWN0aXZlT2Zmc2V0WEVuZCA9IHByb3BzLmFjdGl2ZU9mZnNldFhbMV07XG4gICAgfSBlbHNlIGlmIChwcm9wcy5hY3RpdmVPZmZzZXRYIDwgMCkge1xuICAgICAgcmVzLmFjdGl2ZU9mZnNldFhTdGFydCA9IHByb3BzLmFjdGl2ZU9mZnNldFg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlcy5hY3RpdmVPZmZzZXRYRW5kID0gcHJvcHMuYWN0aXZlT2Zmc2V0WDtcbiAgICB9XG4gIH1cblxuICBpZiAocHJvcHMuYWN0aXZlT2Zmc2V0WSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZGVsZXRlIHJlc1snYWN0aXZlT2Zmc2V0WSddO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHByb3BzLmFjdGl2ZU9mZnNldFkpKSB7XG4gICAgICByZXMuYWN0aXZlT2Zmc2V0WVN0YXJ0ID0gcHJvcHMuYWN0aXZlT2Zmc2V0WVswXTtcbiAgICAgIHJlcy5hY3RpdmVPZmZzZXRZRW5kID0gcHJvcHMuYWN0aXZlT2Zmc2V0WVsxXTtcbiAgICB9IGVsc2UgaWYgKHByb3BzLmFjdGl2ZU9mZnNldFkgPCAwKSB7XG4gICAgICByZXMuYWN0aXZlT2Zmc2V0WVN0YXJ0ID0gcHJvcHMuYWN0aXZlT2Zmc2V0WTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLmFjdGl2ZU9mZnNldFlFbmQgPSBwcm9wcy5hY3RpdmVPZmZzZXRZO1xuICAgIH1cbiAgfVxuXG4gIGlmIChwcm9wcy5mYWlsT2Zmc2V0WCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZGVsZXRlIHJlc1snZmFpbE9mZnNldFgnXTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShwcm9wcy5mYWlsT2Zmc2V0WCkpIHtcbiAgICAgIHJlcy5mYWlsT2Zmc2V0WFN0YXJ0ID0gcHJvcHMuZmFpbE9mZnNldFhbMF07XG4gICAgICByZXMuZmFpbE9mZnNldFhFbmQgPSBwcm9wcy5mYWlsT2Zmc2V0WFsxXTtcbiAgICB9IGVsc2UgaWYgKHByb3BzLmZhaWxPZmZzZXRYIDwgMCkge1xuICAgICAgcmVzLmZhaWxPZmZzZXRYU3RhcnQgPSBwcm9wcy5mYWlsT2Zmc2V0WDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLmZhaWxPZmZzZXRYRW5kID0gcHJvcHMuZmFpbE9mZnNldFg7XG4gICAgfVxuICB9XG5cbiAgaWYgKHByb3BzLmZhaWxPZmZzZXRZICE9PSB1bmRlZmluZWQpIHtcbiAgICBkZWxldGUgcmVzWydmYWlsT2Zmc2V0WSddO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHByb3BzLmZhaWxPZmZzZXRZKSkge1xuICAgICAgcmVzLmZhaWxPZmZzZXRZU3RhcnQgPSBwcm9wcy5mYWlsT2Zmc2V0WVswXTtcbiAgICAgIHJlcy5mYWlsT2Zmc2V0WUVuZCA9IHByb3BzLmZhaWxPZmZzZXRZWzFdO1xuICAgIH0gZWxzZSBpZiAocHJvcHMuZmFpbE9mZnNldFkgPCAwKSB7XG4gICAgICByZXMuZmFpbE9mZnNldFlTdGFydCA9IHByb3BzLmZhaWxPZmZzZXRZO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXMuZmFpbE9mZnNldFlFbmQgPSBwcm9wcy5mYWlsT2Zmc2V0WTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVzO1xufVxuXG5mdW5jdGlvbiBtYW5hZ2VQYW5Qcm9wcyhwcm9wcykge1xuICBpZiAoX19ERVZfXykge1xuICAgIHZhbGlkYXRlUGFuR2VzdHVyZUhhbmRsZXJQcm9wcyhwcm9wcyk7XG4gIH1cbiAgcmV0dXJuIHRyYW5zZm9ybVBhbkdlc3R1cmVIYW5kbGVyUHJvcHMocHJvcHMpO1xufVxuXG5leHBvcnQgY29uc3QgUGFuR2VzdHVyZUhhbmRsZXIgPSBjcmVhdGVIYW5kbGVyKFxuICAnUGFuR2VzdHVyZUhhbmRsZXInLFxuICB7XG4gICAgLi4uR2VzdHVyZUhhbmRsZXJQcm9wVHlwZXMsXG4gICAgYWN0aXZlT2Zmc2V0WTogUHJvcFR5cGVzLm9uZU9mVHlwZShbXG4gICAgICBQcm9wVHlwZXMubnVtYmVyLFxuICAgICAgUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLm51bWJlciksXG4gICAgXSksXG4gICAgYWN0aXZlT2Zmc2V0WDogUHJvcFR5cGVzLm9uZU9mVHlwZShbXG4gICAgICBQcm9wVHlwZXMubnVtYmVyLFxuICAgICAgUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLm51bWJlciksXG4gICAgXSksXG4gICAgZmFpbE9mZnNldFk6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1xuICAgICAgUHJvcFR5cGVzLm51bWJlcixcbiAgICAgIFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5udW1iZXIpLFxuICAgIF0pLFxuICAgIGZhaWxPZmZzZXRYOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtcbiAgICAgIFByb3BUeXBlcy5udW1iZXIsXG4gICAgICBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMubnVtYmVyKSxcbiAgICBdKSxcbiAgICBtaW5EaXN0OiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIG1pblZlbG9jaXR5OiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIG1pblZlbG9jaXR5WDogUHJvcFR5cGVzLm51bWJlcixcbiAgICBtaW5WZWxvY2l0eVk6IFByb3BUeXBlcy5udW1iZXIsXG4gICAgbWluUG9pbnRlcnM6IFByb3BUeXBlcy5udW1iZXIsXG4gICAgbWF4UG9pbnRlcnM6IFByb3BUeXBlcy5udW1iZXIsXG4gICAgYXZnVG91Y2hlczogUHJvcFR5cGVzLmJvb2wsXG4gIH0sXG4gIHt9LFxuICBtYW5hZ2VQYW5Qcm9wcyxcbiAge1xuICAgIGFjdGl2ZU9mZnNldFlTdGFydDogdHJ1ZSxcbiAgICBhY3RpdmVPZmZzZXRZRW5kOiB0cnVlLFxuICAgIGFjdGl2ZU9mZnNldFhTdGFydDogdHJ1ZSxcbiAgICBhY3RpdmVPZmZzZXRYRW5kOiB0cnVlLFxuICAgIGZhaWxPZmZzZXRZU3RhcnQ6IHRydWUsXG4gICAgZmFpbE9mZnNldFlFbmQ6IHRydWUsXG4gICAgZmFpbE9mZnNldFhTdGFydDogdHJ1ZSxcbiAgICBmYWlsT2Zmc2V0WEVuZDogdHJ1ZSxcbiAgfVxuKTtcbmV4cG9ydCBjb25zdCBQaW5jaEdlc3R1cmVIYW5kbGVyID0gY3JlYXRlSGFuZGxlcihcbiAgJ1BpbmNoR2VzdHVyZUhhbmRsZXInLFxuICBHZXN0dXJlSGFuZGxlclByb3BUeXBlcyxcbiAge31cbik7XG5leHBvcnQgY29uc3QgUm90YXRpb25HZXN0dXJlSGFuZGxlciA9IGNyZWF0ZUhhbmRsZXIoXG4gICdSb3RhdGlvbkdlc3R1cmVIYW5kbGVyJyxcbiAgR2VzdHVyZUhhbmRsZXJQcm9wVHlwZXMsXG4gIHt9XG4pO1xuIl19